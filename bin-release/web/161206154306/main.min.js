var GameUtil;!function(t){var e=function(t){function e(e,i,n){t.call(this),this.init(e,i,n)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(t,e,i){this.texture=t,this.$setX(e),this.$setY(i),this.setanchorOff(.5,.5)},n.setNewTexture=function(t){this.texture=t},n.setanchorOff=function(t,e){this.anchorOffsetX=this.$getWidth()*t,this.anchorOffsetY=this.$getHeight()*e},e}(egret.Bitmap);t.MyBitmap=e,egret.registerClass(e,"GameUtil.MyBitmap")}(GameUtil||(GameUtil={}));var BombSprite=function(t){function e(e,i,n,a){t.call(this,e,i,n),this.isbomed=!1,this.isplayerb=!1,this.start(),this.isplayerb=a}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initdata=function(){this.gamecontain=this.parent.parent,this.parcontain=this.parent},n.start=function(){var t=this;this.tw=egret.Tween.get(this,{loop:!0}).to({scaleX:.9,scaleY:.9}).to({scaleX:1,scaleY:1},400),this.titag=egret.setTimeout(t.bomb,this,3e3)},n.bomb=function(){var t=RES.getRes("bombsound_ogg");t.play(0,1),egret.clearTimeout(this.titag),this.tw.loop=!1,egret.Tween.removeTweens(this.tw),this.visible=!1,this.parcontain.removeChild(this);var e=this.gamecontain.bombarr.indexOf(this);this.gamecontain.bombarr.splice(e,1);var i=this.parcontain;this.bombefl=new GameUtil.MyBitmap(RES.getRes("bombeffectl_png"),this.x,this.y),this.bombefl.$setScaleX(0),i.addChild(this.bombefl),this.gamecontain.bomeffectarr.push(this.bombefl),this.bombefp=new GameUtil.MyBitmap(RES.getRes("bombeffectp_png"),this.x,this.y),this.bombefp.$setScaleY(0),i.addChild(this.bombefp),this.gamecontain.bomeffectarr.push(this.bombefp),egret.Tween.get(this.bombefl).to({scaleX:1},200),egret.Tween.get(this.bombefp).to({scaleY:1},200).call(this.checkhit,this)},n.checkhit=function(){var t=this.gamecontain;if(this.isbomed=!0,GameData._i().GameOver){if(null==this.parcontain)return;egret.clearTimeout(this.titag),this.tw.loop=!1,egret.Tween.removeTweens(this.tw),this.parcontain.removeChild(this.bombefl),this.parcontain.removeChild(this.bombefp);var e=t.bomeffectarr.indexOf(this.bombefl);t.bomeffectarr.splice(e,1);var i=t.bomeffectarr.indexOf(this.bombefp);return void t.bomeffectarr.splice(i,1)}for(var n=0;n<t.bombarr.length;n++){var a=t.bombarr[n],r=this.getrect(a),s=this.getrect(this.bombefl),o=this.getrect(this.bombefp);(r.intersects(s)||r.intersects(o))&&a.bomb()}for(var n=0;n<t.rolearr.length;n++){var r=this.getrect(t.rolearr[n]),s=this.getrect(this.bombefl),o=this.getrect(this.bombefp),h=t.rolearr[n];h.isSuperstate||!r.intersects(s)&&!r.intersects(o)||t.rolearr[n].die(this.isplayerb)}this.parcontain.removeChild(this.bombefl),this.parcontain.removeChild(this.bombefp);var e=t.bomeffectarr.indexOf(this.bombefl);t.bomeffectarr.splice(e,1);var i=t.bomeffectarr.indexOf(this.bombefp);t.bomeffectarr.splice(i,1)},n.getrect=function(t){var e=t.getBounds();return e.x=t.x-t.width/2,e.y=t.y-t.height/2,e},e}(GameUtil.MyBitmap);egret.registerClass(BombSprite,"BombSprite");var Dircontorllayer=function(t){function e(e,i,n,a,r){t.call(this,e,i,n),this.initobj(a,r)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initobj=function(t,e){this.playerrole=e,this.touchID=t,this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.DirTouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.DirTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.DirTouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.DirTouchCancel,this)},n.DirTouchBegin=function(t){if(4==this.touchID);else for(var e=this.parent,i=0;i<e.controldirarr.length;i++){var n=e.controldirarr[i];if(n.hitTestPoint(t.$stageX,t.stageY)){var a=parseInt(n.name);this.touchID=a,this.playerrole.startmove(this.touchID);break}}},n.DirTouchMove=function(t){if(4==this.touchID);else for(var e=this.parent,i=0;i<e.controldirarr.length;i++){var n=e.controldirarr[i];if(n.hitTestPoint(t.$stageX,t.stageY)){var a=parseInt(n.name);if(this.touchID!=a){this.touchID=a,this.playerrole.stopmove(),this.playerrole.startmove(this.touchID);break}}}},n.DirTouchEnd=function(t){4==this.touchID?this.playerrole.putbomb():(this.playerrole.stopmove(),this.touchID=-1)},n.DirTouchCancel=function(t){4==this.touchID||(this.playerrole.stopmove(),this.touchID=-1)},e}(GameUtil.MyBitmap);egret.registerClass(Dircontorllayer,"Dircontorllayer");var GameData=function(){function t(){this.GameOver=!1,this.isLoadingend=!1,this.isgetInfoend=!1,this.UserInfo={ID:"",nickname:"",gender:0,roletype:"",rolename:0,openid:"",paopaocount:0,jifen:0,killcount:0,bekillcount:0,shareopenid:"",prizecount:3}}var e=(__define,t),i=e.prototype;return i.init=function(){console.log("init"),this.PlayerRoleType=0,this.PlayerToolType=0,this.PlayerBubbleNumber=this.UserInfo.paopaocount,this.PlayerHadrole=[0],this.PlayerHadtool=[0],this.PlayerRoleSpeed=20,this.PlayerScore=0,this.PlayerKill=0,this.PlayerDied=0},t._i=function(){return this._inst=null==this._inst?new t:this._inst},t.AIROLENUM=4,t.OBSNUM=25,t._inst=null,t}();egret.registerClass(GameData,"GameData");var GameUtil;!function(t){var e=function(t){function e(){t.call(this),this.mStageW=egret.MainContext.instance.stage.stageWidth,this.mStageH=egret.MainContext.instance.stage.stageHeight,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onAddToStage=function(t){this.init()},n.init=function(){},e}(egret.DisplayObjectContainer);t.BassPanel=e,egret.registerClass(e,"GameUtil.BassPanel");var i=function(){function e(){}var i=(__define,e);i.prototype;return e.init=function(t){this.MainStage=t},e.runscene=function(e,i,n){if(void 0===i&&(i=t.GameConfig.NullAction),void 0===n&&(n=800),null==this.curScene)return this.curScene=e,void this.MainStage.addChild(this.curScene);if(i==t.GameConfig.NullAction)return null!=this.curScene&&this.MainStage.removeChild(this.curScene),this.curScene=e,void this.MainStage.addChild(this.curScene);this.nextScene=e,this.MainStage.addChild(this.nextScene),i==t.GameConfig.TransAlpha&&(this.nextScene.alpha=0,egret.Tween.get(this.curScene).to({alpha:0},n),egret.Tween.get(this.nextScene).to({alpha:1},n)),i==t.GameConfig.CrossLeft&&(this.nextScene.x=-this.MainStage.stageWidth,egret.Tween.get(this.curScene).to({x:this.MainStage.stageWidth},n),egret.Tween.get(this.nextScene).to({x:0},n)),i==t.GameConfig.OpenDoor;var a=this;egret.setTimeout(function(){a.MainStage.removeChild(a.curScene),a.curScene=a.nextScene},this,n)},e.curScene=null,e.nextScene=null,e.MainStage=null,e}();t.GameScene=i,egret.registerClass(i,"GameUtil.GameScene")}(GameUtil||(GameUtil={}));var GameOverScene=function(t){function e(e,i,n,a){t.call(this),this.initdata(e,i,n,a)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initdata=function(t,e,i,n){this.showgameoverbg(t,e,i,n)},n.showgameoverbg=function(t,e,i,n){this.touchEnabled=!0;var a=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.6);this.addChild(a);var r={openid:GameData._i().UserInfo.openid,type:3,count:GameData._i().PlayerKill};GameUtil.Http.getinstance().send(r,"/paopao/updatekilldata",this.sendanother,this)},n.sendanother=function(t){if(1==t.code){var e={openid:GameData._i().UserInfo.openid,type:4,count:GameData._i().PlayerDied};GameUtil.Http.getinstance().send(e,"/paopao/updatekilldata",this.showscene,this)}else t.msg},n.showscene=function(t){if(1==t.code){var e=new GameUtil.MyBitmap(RES.getRes("gameoverbg_png"),this.mStageW/2,this.mStageH/2);this.addChild(e);var i=new GameUtil.MyBitmap(RES.getRes("gameovertext_png"),this.mStageW/2,512);this.addChild(i);for(var n=["gameovershare_png","gameoverturnback_png","gameoverrelife_png"],a=[this.share,this.turnback,this.relife],r=0;3>r;r++){var s=new GameUtil.Menu(this,n[r],n[r],a[r]);s.x=215+160*r,s.y=965,this.addChild(s)}for(var o=["得分:","击杀:","被杀:","反杀:"],h=[150*GameData._i().PlayerKill,GameData._i().PlayerKill,GameData._i().PlayerDied,0],r=0;4>r;r++){var l=new GameUtil.MyTextField(253,588+60*r,50,0,0);l.setText(o[r]),l.textColor=16777215,this.addChild(l);var c=new GameUtil.MyTextField(378,588+60*r,50,0,0);c.setText(""+h[r]),c.textColor=16116555,this.addChild(c)}}else t.msg},n.share=function(){var t=new egret.DisplayObjectContainer;this.addChild(t);var e=this,i=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.6);t.addChild(i),i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.removeChild(t)},this);var n=new GameUtil.MyBitmap(RES.getRes("sharetip_png"),this.mStageW,0);n.setanchorOff(1,0),t.addChild(n)},n.turnback=function(){GameData._i().PlayerDied=0,GameData._i().PlayerKill=0,GameData._i().PlayerScore=0,this.parent.removeChild(this),GameUtil.GameScene.runscene(new StartGameScene)},n.relife=function(){var t=this.parent;t.reset();for(var e=0;e<t.rolearr.length;e++){var i=t.rolearr[e];i.reset()}this.parent.removeChild(this)},e}(GameUtil.BassPanel);egret.registerClass(GameOverScene,"GameOverScene");var DIRECTION;!function(t){t[t.UP=0]="UP",t[t.RIGHT=1]="RIGHT",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT"}(DIRECTION||(DIRECTION={}));var GameScene=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(){this.rolearr=[],this.bombarr=[],this.readybomarr=[],this.bomeffectarr=[],this.controldirarr=[],GameData._i().GameOver=!1,this.showgamebg()},n.showgamebg=function(){this.GameMapContain=new egret.DisplayObjectContainer,this.addChild(this.GameMapContain);var t=new GameUtil.MyBitmap(RES.getRes("mapblue_png"),this.mStageW/2,this.mStageH/2);this.GameMapContain.addChild(t),this.playerrole=new RoleSprite("roletype"+GameData._i().PlayerRoleType,4,80,this.mStageW/2,this.mStageH/2,!1),this.GameMapContain.addChild(this.playerrole),this.playerrole.setSuperstate(),this.playerrole.initgamecontain(),this.playerrole.setLoop(-1),this.playerrole.play(),this.playerrole.pause(),this.playerrole.speed=GameData._i().PlayerRoleSpeed,this.rolearr.push(this.playerrole);for(var e=0;e<GameData.AIROLENUM;e++)this.createrole();this.obscontain=new egret.DisplayObjectContainer,this.GameMapContain.addChild(this.obscontain),this.toolcontain=new egret.DisplayObjectContainer,this.GameMapContain.addChild(this.toolcontain);var i=new Dircontorllayer(RES.getRes("roleControlimg_png"),this.mStageW/2,1120,-1,this.playerrole);this.addChild(i);for(var n=[[375,1e3],[500,1120],[375,1240],[254,1120],[375,1120]],e=0;4>e;e++){var a=new GameUtil.MyBitmap(RES.getRes("helpselect_png"),n[e][0],n[e][1]);a.scaleX=4,a.scaleY=4,a.alpha=0,this.addChild(a),a.name=""+e,this.controldirarr.push(a)}var r=new Dircontorllayer(RES.getRes("putbombtn_png"),this.mStageW/2,1120,4,this.playerrole);this.addChild(r),this.increateobstag=egret.setInterval(this.createobs,this,3e3),this.increatetooltag=egret.setInterval(this.createtool,this,5e3)},n.createrole=function(){var t=[100,500,1e3,2e3],e=[100,400,200,300],i=Math.floor(100*Math.random())%5,n=Math.floor(100*Math.random())%4,a=Math.floor(100*Math.random())%4,r=new RoleSprite("roletype"+i,4,80,t[n],e[a]);this.GameMapContain.addChild(r),r.initgamecontain(),r.setLoop(-1),r.play(),r.pause(),r.speed=20,this.rolearr.push(r)},n.createobs=function(){if(!(this.obscontain.numChildren>=GameData.OBSNUM)){var t=Math.floor(100*Math.random())%12,e=60+Math.floor(1e5*Math.random())%2548,i=60+Math.floor(1e5*Math.random())%1380,n=new Obstrution(RES.getRes("obstrution"+t+"_png"),e,i);this.obscontain.addChild(n)}},n.createtool=function(){if(!(this.toolcontain.numChildren>=4)){var t=Math.floor(100*Math.random())%1,e=60+Math.floor(1e5*Math.random())%2548,i=60+Math.floor(1e5*Math.random())%1380,n=new Obstrution(RES.getRes("tool"+t+"_png"),e,i);this.toolcontain.addChild(n)}},n.gameover=function(){GameData._i().GameOver=!0,egret.clearInterval(this.increateobstag),egret.clearInterval(this.increatetooltag),this.addChild(new GameOverScene(100,1,1,0))},n.reset=function(){GameData._i().GameOver=!1,this.increateobstag=egret.setInterval(this.createobs,this,3e3),this.increatetooltag=egret.setInterval(this.createtool,this,5e3)},e}(GameUtil.BassPanel);egret.registerClass(GameScene,"GameScene");var AdaptGamelayer=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initlayer=function(t){this.maxheight=t},n.putItme=function(t){this.addChild(t)},n.adpat=function(t){void 0===t&&(t=!0);var e=1;this.$getHeight()>this.maxheight&&(e=this.maxheight/this.$getHeight(),t?this.scaleX=this.scaleY=e:this.scaleY=e);var i=(this.mStageW-this.$getWidth()*this.scaleX)/2;this.x=i},e._i=function(){return null==this.inst&&(this.inst=new e),this.inst},e}(GameUtil.BassPanel);egret.registerClass(AdaptGamelayer,"AdaptGamelayer");var GameUtil;!function(t){var e=function(t){function e(e,i,n,a,r){t.call(this,RES.getRes(e+"1_png"),a,r),this.currentNumber=1,this.countNumber=0,this.bLoopCount=0,this.endcallfun=null,this.thisObj=null,this.bpause=!1,this.textureName=e,this.totalNumber=i,this.frameRate=n}__extends(e,t);var i=(__define,e),n=i.prototype;return n.setLoop=function(t){0==t&&(t=1),this.bLoopCount=t-1},n.play=function(){this.intervaltag=egret.setInterval(this.run,this,this.frameRate)},n.run=function(){this.nextFrame()},n.pause=function(){this.bpause=!0},n.resume=function(){this.bpause=!1},n.stop=function(){egret.clearInterval(this.intervaltag)},n.nextFrame=function(){if(!this.bpause){if(this.currentNumber++,this.currentNumber>=this.totalNumber){if(this.currentNumber=1,0==this.bLoopCount)return this.stop(),null!=this.endcallfun&&this.endcallfun.apply(this.thisObj),void this.parent.removeChild(this);this.bLoopCount>0&&this.bLoopCount--}this.setNewTexture(RES.getRes(this.textureName+this.currentNumber+"_png"))}},n.setendcall=function(t,e){this.thisObj=e,this.endcallfun=t},e}(t.MyBitmap);t.Animation=e,egret.registerClass(e,"GameUtil.Animation")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(t){function e(e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),t.call(this),this.imgUrl=e,this.imgwidth=i,this.imgheight=n,this.init()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(){RES.getResByUrl(this.imgUrl,this.comp,this,RES.ResourceItem.TYPE_IMAGE)},n.comp=function(t){this.imag=new egret.Bitmap,this.imag.texture=t,this.addChild(this.imag),0!=this.imgwidth&&(this.imag.width=this.imgwidth),0!=this.imgheight&&(this.imag.height=this.imgheight),this.imag.anchorOffsetX=this.imgwidth/2,this.imag.anchorOffsetY=this.imgheight/2},n.getimg=function(){return this.imag},e}(egret.DisplayObjectContainer);t.GetImageByUrl=e,egret.registerClass(e,"GameUtil.GetImageByUrl")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(t){function e(e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),t.call(this),this.imgUrl=e,this.imgwidth=i,this.imgheight=n,this.init()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(){RES.getResAsync(this.imgUrl,this.comp,this)},n.comp=function(t){this.imag=new egret.Bitmap,this.imag.texture=t,this.addChild(this.imag),0!=this.imgwidth&&(this.imag.width=this.imgwidth),0!=this.imgheight&&(this.imag.height=this.imgheight),this.imag.anchorOffsetX=this.imgwidth/2,this.imag.anchorOffsetY=this.imgheight/2},e}(egret.DisplayObjectContainer);t.GetResByany=e,egret.registerClass(e,"GameUtil.GetResByany")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(){function e(t,e){void 0===t&&(t=egret.URLRequestMethod.POST),void 0===e&&(e=egret.URLLoaderDataFormat.TEXT),this.init(t,e)}var i=(__define,e),n=i.prototype;return n.init=function(t,e){void 0===t&&(t=egret.URLRequestMethod.POST),void 0===e&&(e=egret.URLLoaderDataFormat.TEXT),this.urlLoader=new egret.URLLoader,this.urlLoader.dataFormat=e,this.urlLoader.addEventListener(egret.Event.COMPLETE,this.loaded,this),this.urlRequest=new egret.URLRequest,this.urlRequest.method=t},n.loaded=function(t){this.urlLoader.removeEventListener(egret.Event.COMPLETE,this.loaded,this),this.thisObj.removeChild(this.coverBg);var e=JSON.parse(this.urlLoader.data);null!=this.onLoader&&this.onLoader.apply(this.thisObj,[e])},n.send=function(e,i,n,a,r){void 0===n&&(n=null),void 0===a&&(a=null),void 0===r&&(r=t.GameConfig.IP),this.urlRequest.url="Http://"+r+i,this.onLoader=n,this.thisObj=a;var s=new egret.URLVariables(t.objectToString(e));this.urlRequest.data=s,this.urlLoader.addEventListener(egret.Event.COMPLETE,this.loaded,this),this.urlLoader.load(this.urlRequest),this.coverBg=t.createRect(0,0,window.screen.availWidth,window.screen.availHeight,0),this.thisObj.addChild(this.coverBg),this.coverBg.touchEnabled=!0},n.setReqMethod=function(t){this.urlRequest.method=t},e.getinstance=function(t,i){return void 0===t&&(t=egret.URLRequestMethod.POST),void 0===i&&(i=egret.URLLoaderDataFormat.TEXT),null==e._instance&&(e._instance=new e(t,i)),e._instance},e}();t.Http=e,egret.registerClass(e,"GameUtil.Http")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(t){function e(e,i,n,a,r){void 0===a&&(a=.5),void 0===r&&(r=.5),t.call(this),this.init(e,i,n,a,r)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(t,e,i,n,a){this.textColor=0,this.fontFamily="楷体",this.$setX(t),this.$setY(e),this.$setSize(i),this.anchorX=n,this.anchorY=a},n.setText=function(t){this.text=t,this.setanchorOff(this.anchorX,this.anchorY)},n.setSize=function(t){this.size=t,this.setanchorOff(this.anchorX,this.anchorY)},n.setanchorOff=function(t,e){this.anchorOffsetX=this.$getWidth()*t,this.anchorOffsetY=this.$getHeight()*e},e}(egret.TextField);t.MyTextField=e,egret.registerClass(e,"GameUtil.MyTextField")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(t){function e(e,i,n,a,r,s,o){void 0===s&&(s=.5),void 0===o&&(o=.5),t.call(this,e,i,n,s,o),this.width=a,this.height=n,this.type=egret.TextFieldType.INPUT,this.baseText="",this.addEventListener(egret.FocusEvent.FOCUS_IN,this.onFocusIn,this),this.addEventListener(egret.FocusEvent.FOCUS_OUT,this.onFocusOut,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.setBaseText=function(t,e){this.baseText=t,this.baseTextAlpha=e,this.setText(this.baseText),this.alpha=this.baseTextAlpha},n.setBaseTextSize=function(t,e){this.basetextsize=t,this.sourcesize=e,this.text==this.baseText&&(this.setSize(this.basetextsize),this.height=t)},n.onFocusIn=function(t){this.text==this.baseText&&(this.setText(""),this.height=this.sourcesize,this.setSize(this.sourcesize),this.alpha=1)},n.onFocusOut=function(t){""==this.text&&(this.setText(this.baseText),this.alpha=this.baseTextAlpha,this.height=this.basetextsize,this.setSize(this.basetextsize))},e}(t.MyTextField);t.InputTextFiled=e,egret.registerClass(e,"GameUtil.InputTextFiled")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(){function t(t,e){this.loadedfun=t,this.thisObj=e,this.loadingRes()}var e=(__define,t),i=e.prototype;return i.loadingRes=function(){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},i.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preloading")},i.onResourceLoadComplete=function(t){"preloading"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.loadedfun.apply(this.thisObj))},i.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},i.onResourceProgress=function(t){"preloading"==t.groupName},t}();t.LoadingLogopre=e,egret.registerClass(e,"GameUtil.LoadingLogopre")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(e){function i(t,i,n,a,r,s){void 0===n&&(n=0),void 0===a&&(a=0),void 0===r&&(r=!1),void 0===s&&(s=4),e.call(this),this.loadedfun=t,this.thisObj=i,this.IsGif=r,this.gifTotalcount=s,this.loadingbarOffX=n,this.loadingbarOffY=a}__extends(i,e);var n=(__define,i),a=n.prototype;return a.init=function(){new t.LoadingLogopre(this.onComplete,this);var e={openId:GameData._i().UserInfo.openid,nickname:t.getQueryString("nickname")};t.Http.getinstance().send(e,"/paopao/adduserinfo",this.setplayerinfo,this)},a.onComplete=function(e){if(this.IsGif)this.gifruncount=0,this.loadingbar=new t.MyBitmap(RES.getRes("loadinggif0_png"),this.mStageW/2+this.loadingbarOffX,this.mStageH/2+this.loadingbarOffY),this.addChild(this.loadingbar),egret.setInterval(this.rungif,this,150);else{this.loadingbar=new t.MyBitmap(RES.getRes("loadingbar_png"),this.loadingbarOffX,this.mStageH/2+this.loadingbarOffY),this.loadingbar.x=(this.mStageW-this.loadingbar.texture.textureWidth)/2,this.loadingbar.anchorOffsetX=0;var i=this.loadingbar.texture.textureWidth-8,n=this.loadingbar.texture.textureHeight-8,a=new egret.Rectangle(4,4,i,n);this.loadingbar.scale9Grid=a,this.addChild(this.loadingbar),this.loadingbar.width=10}this.loadingRes()},a.rungif=function(){this.gifruncount++,this.gifruncount>=this.gifTotalcount&&(this.gifruncount=0),this.loadingbar.setNewTexture(RES.getRes("loadinggif"+this.gifruncount+"_png"))},a.loadingRes=function(){this.loadingView=new LoadingUI,this.loadingView.x=this.mStageW/2,this.loadingView.y=this.mStageH/2+this.loadingbarOffY+30,this.addChild(this.loadingView),this.loadingView.anchorOffsetX=this.loadingView.width/2,RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},a.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preload")},a.onResourceLoadComplete=function(t){"preload"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.loadedfun.apply(this.thisObj))},a.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},a.onResourceProgress=function(t){"preload"==t.groupName&&(this.IsGif||this.setPro(t.itemsLoaded/t.itemsTotal),this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal))},a.setPro=function(t){this.loadingbar.width=this.loadingbar.texture.textureWidth*t},a.getPro=function(){return this.loadingbar.width/this.loadingbar.texture.textureWidth},a.setplayerinfo=function(t){if(console.log("inforesult=========",t),0==t.code)console.log(t.msg);else{var e=t.result;console.log(e),GameData._i().UserInfo.ID=e.id,GameData._i().UserInfo.nickname=e.nickname,GameData._i().UserInfo.gender=e.gender,GameData._i().UserInfo.roletype=e.roletype,GameData._i().UserInfo.rolename=e.rolename,GameData._i().UserInfo.openid=e.openid,GameData._i().UserInfo.paopaocount=e.paopaocount,GameData._i().UserInfo.jifen=e.jifen,GameData._i().UserInfo.killcount=e.killcount,GameData._i().UserInfo.bekillcount=e.bekillcount,GameData._i().UserInfo.prizecount=3-e.prizecount,GameData._i().init(),GameData._i().isLoadingend=!0}},i}(t.BassPanel);t.LoadingPanel=e,egret.registerClass(e,"GameUtil.LoadingPanel")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(e){function i(t,i,n,a,r,s){void 0===r&&(r=null),void 0===s&&(s=null),e.call(this),this.menuNormalTexture=null,this.menuSelectTexture=null,this.menubgimg=null,this.bScaleMode=!1,this.mScale=.9,this.isActive=!1,this.thisObj=t,this.param=r,this.menubgimg=s,this.btnImg=null,null!=this.menubgimg?this.initwithshape(a):this.initwithimg(i,n,a)}__extends(i,e);var n=(__define,i),a=n.prototype;return a.initwithimg=function(e,i,n){void 0===n&&(n=null),this.menuNormalTexture=RES.getRes(e),this.menuSelectTexture=RES.getRes(i),this.backFun=n,this.btnImg=new t.MyBitmap(this.menuNormalTexture,0,0),this.addChild(this.btnImg),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.TouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.TouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.TouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.TouchCancel,this)},a.initwithshape=function(t){this.backFun=t,this.addChild(this.menubgimg),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.TouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.TouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.TouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.TouchCancel,this)},a.setBackFun=function(t){this.backFun=t},a.setScaleMode=function(t){void 0===t&&(t=.9),this.bScaleMode=!0,this.mScale=t},a.setButtonTexture=function(t,e){this.menuNormalTexture=RES.getRes(t),this.menuSelectTexture=RES.getRes(e),this.btnImg.setNewTexture(this.menuNormalTexture)},a.addButtonImg=function(e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this.addImg=new t.MyBitmap(RES.getRes(e),i,n),this.addChild(this.addImg)},a.setAddImgTexture=function(t){this.addImg.setNewTexture(RES.getRes(t))},a.addButtonText=function(e,i,n,a){void 0===n&&(n=0),void 0===a&&(a=0),null!=this.btnImg?this.mTextField=new t.MyTextField(n,a,i):this.mTextField=new t.MyTextField(n,a,i),this.mTextField.setText(e),this.addChild(this.mTextField)},a.getBtnText=function(){return this.mTextField},a.setBtnScale=function(t,e){this.btnImg.scaleX=t,this.btnImg.scaleY=e},a.TouchBegin=function(t){var e=RES.getRes("clicksound_ogg");e.play(0,1),null!=this.btnImg&&this.btnImg.setNewTexture(this.menuSelectTexture),this.bScaleMode&&(this.scaleX=this.scaleY=this.mScale),this.isActive=!0},a.TouchMove=function(t){},a.TouchEnd=function(t){null!=this.btnImg&&this.btnImg.setNewTexture(this.menuNormalTexture),this.bScaleMode&&(this.scaleX=this.scaleY=1),this.isActive&&this.backFun.apply(this.thisObj,this.param),this.isActive=!1},a.TouchCancel=function(t){null!=this.btnImg&&this.btnImg.setNewTexture(this.menuNormalTexture),this.bScaleMode&&(this.scaleX=this.scaleY=1),this.isActive=!1},i}(egret.DisplayObjectContainer);t.Menu=e,egret.registerClass(e,"GameUtil.Menu")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(e){function i(t,i,n,a,r,s){void 0===r&&(r=0),void 0===s&&(s=.5),e.call(this),this.mPercent=100,this.init(t,i,n,a,r,s)}__extends(i,e);var n=(__define,i),a=n.prototype;return a.init=function(e,i,n,a,r,s){this.progressbar=new t.MyBitmap(RES.getRes(e),i,n),this.addChild(this.progressbar),this.progressbar.scale9Grid=a,this.progressbar.setanchorOff(r,s)},a.setbarX=function(t){this.progressbar.x=t},a.setbarY=function(t){this.progressbar.y=t},a.setPercent=function(t){0>t||(this.mPercent=t,this.updateWidth())},a.getPercent=function(){return this.mPercent},a.updateWidth=function(){this.progressbar.width=this.progressbar.texture.textureWidth*this.mPercent},i}(egret.DisplayObjectContainer);t.ProgressBar=e,egret.registerClass(e,"GameUtil.ProgressBar")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(e){function i(t,i){e.call(this),this.item=[],this.curseltTag=0,this.itemCount=-1,this.normalTexture=t,this.selectTexture=i,this.init()}__extends(i,e);var n=(__define,i),a=n.prototype;return a.init=function(){},a.addItem=function(e,i,n){this.itemCount++;var a=new egret.DisplayObjectContainer,r=new t.Menu(this,this.normalTexture,this.normalTexture,this.chooseButton,[this.itemCount]);r.x=i,r.y=n,a.addChild(r),e.x=i+r.width/2+e.width/2,e.y=n,a.addChild(e),this.item.push(r),this.addChild(a),0==this.itemCount&&r.setButtonTexture(this.selectTexture,this.selectTexture)},a.chooseButton=function(t){if(t!=this.curseltTag){var e=this.item[t];e.setButtonTexture(this.selectTexture,this.selectTexture);var i=this.item[this.curseltTag];i.setButtonTexture(this.normalTexture,this.normalTexture),this.curseltTag=t}},a.getCurSelectTag=function(){return this.curseltTag},i}(egret.DisplayObjectContainer);t.RadioButton=e,egret.registerClass(e,"GameUtil.RadioButton")}(GameUtil||(GameUtil={}));var RandomUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.limit=function(t,e){t=Math.min(t,e),e=Math.max(t,e);var i=e-t;return t+Math.random()*i},t.limitInteger=function(t,e){return Math.floor(this.limit(t,e+1))},t.randomArray=function(t){var e=Math.floor(Math.random()*t.length);return t[e]},t}();egret.registerClass(RandomUtils,"RandomUtils");var GameUtil;!function(t){var e=function(t){function e(e,i,n){void 0===n&&(n=.5),t.call(this),this.scrollview=new egret.ScrollView,this.content=new egret.DisplayObjectContainer,this.addChild(this.scrollview),this.scrollview.width=e,this.scrollview.height=i,this.scrollview.scrollSpeed=n,this.init()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(){this.scrollview.setContent(this.content)},n.putItem=function(t){this.content.addChild(t)},n.clearItem=function(){this.content.removeChildren()},n.getScorllTop=function(){return this.scrollview.scrollTop},n.setScorllTop=function(t){this.scrollview.scrollTop=t},e}(egret.DisplayObjectContainer);t.ScrollView=e,egret.registerClass(e,"GameUtil.ScrollView")}(GameUtil||(GameUtil={}));var SharePage=function(t){function e(){t.call(this),this.desctext="盛讯小游戏--泡泡大作战",this.newurl="http://bubblefight.h5.gamexun.com/"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.getSignPackage=function(){var t=encodeURIComponent(window.location.href.split("#")[0]),e={url:t};GameUtil.Http.getinstance().send(e,"/weixinshare/share",this.share,this,"api.h5.gamexun.com")},n.share=function(t){console.log("data======",t),wx.config({debug:!1,appId:t.appId,timestamp:Number(t.timestamp),nonceStr:t.noncestr,signature:t.sign,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo"]}),this.getWeiXinShareTimeline(),this.getWeiXinShareAppMessage()},n.setdesctext=function(t){this.desctext=t,this.getWeiXinShareAppMessage(),this.getWeiXinShareTimeline()},n.setNewUrl=function(t){this.newurl=t,this.getWeiXinShareAppMessage(),this.getWeiXinShareTimeline()},n.getWeiXinShareTimeline=function(){var t=new BodyMenuShareTimeline;t.title=this.desctext,t.link=this.newurl,t.imgUrl="http://bubblefight.h5.gamexun.com/shareicon.png",t.trigger=function(){},t.success=function(){},t.cancel=function(){},t.fail=function(t){},wx.onMenuShareTimeline(t)},n.getWeiXinShareAppMessage=function(){var t=new BodyMenuShareAppMessage;t.title="盛讯小游戏--泡泡大作战",t.desc=this.desctext,t.link=this.newurl,t.imgUrl="http://bubblefight.h5.gamexun.com/shareicon.png",t.trigger=function(){},t.success=function(){},t.cancel=function(){},t.fail=function(t){},wx.onMenuShareAppMessage(t)},e._i=function(){return null==this.inst&&(this.inst=new e),this.inst},e}(egret.DisplayObjectContainer);egret.registerClass(SharePage,"SharePage");var GameUtil;!function(t){var e=function(e){function i(t,i,n,a){void 0===n&&(n=!1),void 0===a&&(a=1200),e.call(this),this.textsize=30,this.mStageW=egret.MainContext.instance.stage.stageWidth,this.mStageH=egret.MainContext.instance.stage.stageHeight,this.tipText=i,this.tipImg=t,this.bDisappear=n,this.disSecond=a,this.init()}__extends(i,e);var n=(__define,i),a=n.prototype;return a.init=function(){if(this.showtip(),!this.bDisappear){var e=t.createRect(0,0,window.screen.availWidth,window.screen.availHeight,.4);this.addChild(e),this.touchEnabled=!0}if(null==this.tipImg){var i=t.createRect(this.mStageW/2,this.mStageH/2,2*this.text.width,1.5*this.text.height,1,9210760);i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,this.addChild(i)}else this.tipbg=new t.MyBitmap(RES.getRes(this.tipImg),this.mStageW/2,this.mStageH/2),this.addChild(this.tipbg);
if(this.bDisappear){var n=egret.Tween.get(this);n.to({alpha:1},300).to({alpha:0},this.disSecond).call(this.close,this)}else this.showbutton();this.addChild(this.text)},a.showtip=function(){this.text=new t.MyTextField(this.mStageW/2,this.mStageH/2,this.textsize),this.text.setText(this.tipText),this.text.textColor=0},a.setTextwidth=function(t){this.text.width=t},a.setTextSize=function(t){this.text.setSize(t)},a.setTextHor=function(t,e,i,n){this.text.textAlign=i,this.text.x=this.mStageW/2-this.tipbg.width/2+n},a.setTextlineSpacing=function(t){this.text.lineSpacing=t},a.showbutton=function(){var e=new t.Menu(this,"acceptBtn_png","acceptBtn_png",this.close);e.x=this.mStageW/2,e.y=this.mStageH/2+this.tipbg.texture.textureHeight/2,this.addChild(e),e.setScaleMode()},a.close=function(){this.parent.removeChild(this)},i}(egret.DisplayObjectContainer);t.TipsPanel=e,egret.registerClass(e,"GameUtil.TipsPanel")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(e){function i(t){void 0===t&&(t=0),e.call(this),this.init(t)}__extends(i,e);var n=(__define,i),a=n.prototype;return a.init=function(e){this.coverBg=t.createRect(0,0,640,1136,0),this.addChild(this.coverBg),this.touchEnabled=!0},a.setAlpha=function(t){this.coverBg.alpha=t},i.getInstace=function(){return null==this._instance&&(this._instance=new t.WaitServerPanel(0)),this._instance},i}(egret.DisplayObjectContainer);t.WaitServerPanel=e,egret.registerClass(e,"GameUtil.WaitServerPanel")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){function e(t,e,i,n,a,r){void 0===a&&(a=1),void 0===r&&(r=0);var s=new egret.Shape;return s.x=t,s.y=e,s.graphics.beginFill(r,a),s.graphics.drawRect(0,0,i,n),s.graphics.endFill(),s}function i(t,e,i,n,a){void 0===n&&(n=1),void 0===a&&(a=0);var r=new egret.Shape;return r.x=t,r.y=e,r.graphics.beginFill(a,n),r.graphics.drawCircle(0,0,i),r.graphics.endFill(),r}function n(t){var e="";for(var i in t){var n=i+"="+t[i];e+=n+"&"}return e=e.substr(0,e.length-1)}function a(t){return/^[\u4e00-\u9fa5]+$/.test(t)}function r(t){return t=t.replace(/^/,"")}function s(t){return t=t.toUpperCase(),/^0\d{2,3}-?\d{7,11}$|^1\d{10}$/.test(t)}function o(t,e,i,n,a,r){var s=new egret.TextField;s.x=e,s.y=i,s.size=n,s.textAlign="center",s.textColor=r,s.text=a,t.addChild(s),s.anchorOffsetX=.5*s.width,s.anchorOffsetY=.5*s.height,egret.Tween.get(s).to({y:i-40},700),egret.Tween.get(s).to({alpha:0},700).call(function(){t.removeChild(s)},t)}function h(t,e){egret.localStorage.setItem(t,e)}function l(t){egret.localStorage.getItem(t)}function c(t){null!=t?egret.localStorage.removeItem(t):egret.localStorage.clear()}function u(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return null!=i?decodeURI(i[2]):null}function d(e){return e>=t.GameConfig.DesignHeight/2?b._i().getSH()-(t.GameConfig.DesignHeight-e):e}function g(){var t=Math.floor(100*Math.random());return t}function m(e,i,n,a,r,s){void 0===s&&(s=t.GameConfig.IP);var o=window.getIP;console.log("ipstr======",o);for(var h,l=0;l<o.split("|").length;l++)if(o.split("|")[l].length>6){h=o.split("|")[l];break}console.log("ipstrspl====",h),console.log("money======",e);var c={openId:i,amount:e,ip:h,nickname:n,gameid:0};t.Http.getinstance().send(c,"/weixinpay/pay",a,r,s)}function p(){var t=window.navigator.userAgent.toLowerCase();return-1!=t.indexOf("micromessenger")?!0:!1}function f(){var t=window.navigator.userAgent.toLowerCase();return-1!=t.indexOf("android")?!0:!1}function v(t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i=new egret.ColorMatrixFilter(e);t.filters=[i]}var b=function(){function e(){this.stagetY=0}var i=(__define,e),n=i.prototype;return e._i=function(){return null==this._instance&&(this._instance=new t.GameConfig),this._instance},n.setStageHeight=function(t){this.stagetY=t},n.getSH=function(){return this.stagetY},e.IP="api.h5.gamexun.com",e.bRunFPS=!1,e.NullAction=0,e.CrossLeft=1,e.TransAlpha=2,e.OpenDoor=3,e.DesignWidth=750,e.DesignHeight=1334,e._instance=null,e}();t.GameConfig=b,egret.registerClass(b,"GameUtil.GameConfig"),t.createRect=e,t.createCircle=i,t.objectToString=n,t.isChineseName=a,t.removeimag=r,t.isPhoneNum=s,t.numberUpDisp=o,t.saveLocalData=h,t.readLocalData=l,t.clearLocalData=c,t.getQueryString=u,t.setscreenY=d,t.getRandom=g,t.getredPack=m,t.isWeiXin=p,t.isAndroid=f,t.changeGray=v}(GameUtil||(GameUtil={}));var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},n.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onAddToStage=function(t){GameData._i().UserInfo.openid=GameUtil.getQueryString("openid"),GameData._i().UserInfo.shareopenid=GameUtil.getQueryString("shareopenid"),console.log("openid======",GameData._i().UserInfo.openid),GameUtil.getQueryString("openid")?(GameUtil.getQueryString("shareopenid")?GameData._i().UserInfo.shareopenid=GameUtil.getQueryString("shareopenid"):GameData._i().UserInfo.shareopenid=null,this.stage.scaleMode=egret.StageScaleMode.EXACT_FIT,GameUtil.GameScene.init(this.stage),GameUtil.GameScene.runscene(new GameUtil.LoadingPanel(this.createGameScene,this,0,0))):GameUtil.getQueryString("shareopenid")?window.location.href="http://api.h5.gamexun.com/weixin/auth?game_redirecturl=http://bubblefight.h5.gamexun.com/&shareopenid="+GameUtil.getQueryString("shareopenid"):window.location.href="http://api.h5.gamexun.com/weixin/auth?game_redirecturl=http://bubblefight.h5.gamexun.com/"},n.createGameScene=function(){GameData._i().isLoadingend?(egret.clearInterval(this.intag),GameUtil.GameConfig._i().setStageHeight(this.stage.stageHeight),GameUtil.GameScene.runscene(new StartGameScene)):this.intag=egret.setInterval(this.createGameScene,this,400)},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var Obstrution=function(t){function e(e,i,n,a){void 0===a&&(a=!0),t.call(this,e,i,n),this.isTool=a}__extends(e,t);var i=(__define,e);i.prototype;return e}(GameUtil.MyBitmap);egret.registerClass(Obstrution,"Obstrution");var RoleSprite=function(t){function e(e,i,n,a,r,s){void 0===s&&(s=!0),t.call(this,e,i,n,a,r),this.isSuperstate=!1,this.isAI=s,this.isAI&&(this.aiIntag=egret.setInterval(this.aiRun,this,1e3))}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initgamecontain=function(){this.gamecontain=this.parent.parent,this.parcontain=this.parent},n.setSuperstate=function(){this.isSuperstate=!0;var t=this;egret.Tween.get(this,{loop:!1}).to({alpha:0},500).to({alpha:1},500).to({alpha:0},500).to({alpha:1},500).to({alpha:0},500).to({alpha:1},500).call(function(){t.isSuperstate=!1},t)},n.aiRun=function(){if(this.stopmove(),!GameData._i().GameOver&&null!=this.parent){var t=this,e=Math.floor(100*Math.random());if(e>80){var t=this;this.putbomb(),this.stopmove(),egret.clearInterval(this.aiIntag),egret.setTimeout(function(){t.aiIntag=egret.setInterval(t.aiRun,t,1e3)},t,3e3),e%=4,this.startmove(e)}else e%=4,this.startmove(e)}},n.startmove=function(t){this.rolemovedir=t,this.intage=egret.setInterval(this.moving,this,100),this.resume()},n.moving=function(){var t=this.parcontain;if(null!=t){for(var e=this.gamecontain.obscontain,i=this.gamecontain.toolcontain,n=0;n<i.numChildren;n++){var a=i.getChildAt(n),r=this.getrect(a),s=this.getrect(this);r.intersects(s)&&(i.removeChild(a),this.speed+=5)}for(var o=[!1,!1,!1,!1],n=0;n<e.numChildren;n++){var a=e.getChildAt(n),r=this.getrect(a),s=this.getrect(this);r.intersects(s)&&(a.y>this.y?o[DIRECTION.DOWN]=!0:a.y<this.y&&(o[DIRECTION.UP]=!0),a.x<this.x?o[DIRECTION.LEFT]=!0:a.x>this.x&&(o[DIRECTION.RIGHT]=!0))}var h=this.speed;switch(this.rolemovedir){case DIRECTION.UP:if(o[DIRECTION.UP])return;this.isAI?this.y=this.y-h<=0?0:this.y-h:83==t.y?this.y=this.y-h<=0?0:this.y-h:(t.y=t.y+h>=83?83:t.y+h,this.y-=h);break;case DIRECTION.RIGHT:if(o[DIRECTION.RIGHT])return;this.$setScaleX(1),this.isAI?this.x=this.x+h>=1720-this.width?1720-this.width:this.x+h:-959==t.x?this.x=this.x+h>=1720-this.width?1720-this.width:this.x+h:(t.x=t.x-h<=-959?-959:t.x-h,this.x+=h);break;case DIRECTION.DOWN:if(o[DIRECTION.DOWN])return;this.isAI?this.y=this.y+h>=1500-this.height-74?1500-this.height-74:this.y+h:-83==t.y?this.y=this.y+h>=1500-this.height-74?1500-this.height-74:this.y+h:(t.y=t.y-h<=-83?-83:t.y-h,this.y+=h);break;case DIRECTION.LEFT:if(this.$setScaleX(-1),o[DIRECTION.LEFT])return;this.isAI?this.x=this.x-h<=-980+this.width?-980+this.width:this.x-h:959==t.x?this.x=this.x-h<=-980+this.width?-980+this.width:this.x-h:(t.x=t.x+h>=959?959:t.x+h,this.x-=h)}}},n.stopmove=function(){this.pause(),egret.clearInterval(this.intage)},n.putbomb=function(){var t=RES.getRes("putbombsound_ogg");t.play(0,1);var e=this.parcontain,i=this.gamecontain,n=new BombSprite(RES.getRes("shopselftool_"+GameData._i().PlayerToolType+"_png"),this.x,this.y,!this.isAI);i.bombarr.push(n),e.addChild(n),n.initdata(),e.swapChildren(this,n)},n.die=function(t){if(this.isAI){t&&(GameData._i().PlayerKill++,GameData._i().UserInfo.killcount++,GameData._i().UserInfo.jifen+=150);var e=this.gamecontain;egret.clearInterval(this.aiIntag),this.stopmove(),this.parcontain.removeChild(this);var i=e.rolearr.indexOf(this);e.rolearr.splice(i,1),e.createrole()}else{var n=RES.getRes("diesound_ogg");n.play(0,1),GameData._i().PlayerDied++,GameData._i().UserInfo.bekillcount++;for(var e=this.gamecontain,a=0;a<e.rolearr.length;a++){var r=e.rolearr[a];egret.clearInterval(r.aiIntag),r.stopmove()}e.gameover()}},n.getrect=function(t){var e=t.getBounds();return e.x=t.x-t.width/2,e.y=t.y-t.height/2,e},n.reset=function(){this.isAI?this.aiIntag=egret.setInterval(this.aiRun,this,1e3):this.setSuperstate()},e}(GameUtil.Animation);egret.registerClass(RoleSprite,"RoleSprite");var StartGameScene=function(t){function e(){t.call(this),this.soundswitch=[!0,!0],this.burolecount=[50,80,100,120,140,160],this.butoolcount=[50,80,100,120,130,150],this.activerunluck=!0,this.getbubblecount=0}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(){this.showbg()},n.showbg=function(){GameData._i().UserInfo.nickname=GameUtil.getQueryString("nickname"),this.othercontain=null,this.playcontain=null;var t=new GameUtil.MyBitmap(RES.getRes("startgamebg_png"),0,0);t.setanchorOff(0,0),this.addChild(t);for(var e=["startgamebtn_png","rankbtn_png","helpbtn_png","luckactbtn_png","personbtn_png","settingbtn_png","sharebtn_png","shopbtn_png"],i=[this.startgame,this.gamerank,this.gamehelp,this.luckact,this.personinfo,this.setting,this.share,this.shop],n=[this.mStageW/2,this.mStageW/2,380,65,55,260,685,500],a=[950,1100,1260,750,50,1260,50,1260],r=0;8>r;r++){var s=new GameUtil.Menu(this,e[r],e[r],i[r]);s.setScaleMode(),s.x=n[r],s.y=a[r],this.addChild(s)}GameUtil.getQueryString("shareopenid")?(console.log("shareopen enter"),this.getsharebubble()):(SharePage._i().getSignPackage(),SharePage._i().setNewUrl("http://bubblefight.h5.gamexun.com/?shareopenid="+GameData._i().UserInfo.openid)),0!=GameData._i().UserInfo.prizecount&&this.luckact()},n.getsharebubble=function(){var t={shareopenid:GameUtil.getQueryString("shareopenid"),clickopenid:GameData._i().UserInfo.openid};GameUtil.Http.getinstance().send(t,"/paopao/updatesharedata",this.setshareresult,this)},n.setshareresult=function(t){1==t.code?(SharePage._i().getSignPackage(),SharePage._i().setNewUrl("http://bubblefight.h5.gamexun.com/?shareopenid="+GameData._i().UserInfo.openid)):console.log(t.msg)},n.startgame=function(){console.log("start");var t=RES.getRes("startsound_ogg");t.play(0,1),GameUtil.GameScene.runscene(new GameScene)},n.gamerank=function(){console.log("rank");var t={};GameUtil.Http.getinstance().send(t,"/paopao/getrank",this.getRank,this)},n.getRank=function(t){if(1==t.code){var e=t.result;console.log("rankdata====",e),this.createContain();var i=new GameUtil.MyBitmap(RES.getRes("rankbg_png"),this.mStageW/2,this.mStageH/2);this.othercontain.addChild(i);var n=new GameUtil.MyBitmap(RES.getRes("ranktext_png"),this.mStageW/2,515);this.othercontain.addChild(n);for(var a=0;a<e.length;a++){var r=GameUtil.createRect(141,576+51*a,469,38,0),s=new GameUtil.Menu(this,null,null,this.showotherinfo,[e[a].openid],r);this.othercontain.addChild(s);var o=GameUtil.createCircle(160,600+52*a,12,1,11707196);this.othercontain.addChild(o);var h=GameUtil.createCircle(160,600+52*a,11,1,16377970);this.othercontain.addChild(h);var l=new GameUtil.MyTextField(155,600+52*a,20,0);l.$setStroke(2),l.$setStrokeColor(16645455),l.setText(""+(a+1)),l.textColor=16762462,this.othercontain.addChild(l);var c=new GameUtil.MyTextField(180,600+52*a,25,0);c.setText(e[a].nickname),c.textColor=16777215,this.othercontain.addChild(c);var u=new GameUtil.MyTextField(333,600+52*a,25,0);u.setText("积分:  "+e[a].jifen),u.textColor=16777215,this.othercontain.addChild(u);var d=new GameUtil.MyTextField(470,600+52*a,25,0);d.setText("杀敌:  "+e[a].killcount),d.textColor=16777215,this.othercontain.addChild(d)}var g=new GameUtil.Menu(this,"closebtn_png","closebtn_png",this.closecontain);g.x=653,g.y=482,this.othercontain.addChild(g)}else console.log(t.msg)},n.gameaction=function(){console.log("gameaction")},n.gamehelp=function(){console.log("gamehelp"),this.createContain(),this.helpcurtag=0;var t=this;this.helpbgbtn=new GameUtil.MyBitmap(RES.getRes("helpbg_0_png"),this.mStageW/2,694),this.helpbgbtn.touchEnabled=!0;var e=0;this.helpbgbtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){e=t.stageX},this),this.helpbgbtn.addEventListener(egret.TouchEvent.TOUCH_END,function(i){var n=i.stageX;n-e>=100?t.helpcurtag=++t.helpcurtag>2?0:t.helpcurtag:e-n>100&&(t.helpcurtag=--t.helpcurtag<0?2:t.helpcurtag),t.helpbgbtn.setNewTexture(RES.getRes("helpbg_"+this.helpcurtag+"_png")),t.helpselect.x=367+55*t.helpcurtag},this),this.othercontain.addChild(this.helpbgbtn);for(var i=0;3>i;i++){var n=new GameUtil.MyBitmap(RES.getRes("helppagepoint_png"),367+55*i,800);this.othercontain.addChild(n)}this.helpselect=new GameUtil.MyBitmap(RES.getRes("helpselect_png"),367,800),this.othercontain.addChild(this.helpselect);var a=new GameUtil.Menu(this,"helpclose_png","helpclose_png",this.closecontain);a.x=640,a.y=566,this.othercontain.addChild(a)},n.luckact=function(){console.log("luckact"),this.createContain(),this.freecountT=new GameUtil.MyTextField(this.mStageW/2,320,40,.5,.5),this.freecountT.setText("免费抽奖次数:"+GameData._i().UserInfo.prizecount+"/3"),this.freecountT.textColor=16141124,this.othercontain.addChild(this.freecountT);var t=new GameUtil.MyBitmap(RES.getRes("luckpan_png"),this.mStageW/2,this.mStageH/2);this.othercontain.addChild(t),this.luckpoint=new GameUtil.Menu(this,"luckpoint_png","luckpoint_png",this.runluckpoint),this.luckpoint.$setAnchorOffsetY(25),this.luckpoint.x=this.mStageW/2+6,this.luckpoint.y=665,this.othercontain.addChild(this.luckpoint),0==GameData._i().UserInfo.prizecount&&(GameUtil.changeGray(this.luckpoint),this.luckpoint.$setTouchEnabled(!1));var e=new GameUtil.Menu(this,"closebtn_png","closebtn_png",this.closecontain);e.x=570,e.y=250,this.othercontain.addChild(e)},n.personinfo=function(){console.log("personinfo"),this.createContain();var t=new GameUtil.MyBitmap(RES.getRes("personinfobg_png"),this.mStageW/2,this.mStageH/2);this.othercontain.addChild(t);var e=new GameUtil.Menu(this,"personinfobtn_png","personinfobtn_png",this.playinfo);e.setScaleMode(),e.x=186,e.y=531,this.othercontain.addChild(e);var i=new GameUtil.Menu(this,"bagbtn_png","bagbtn_png",this.playbag);i.setScaleMode(),i.x=386,i.y=531,this.othercontain.addChild(i),this.playcontain=new egret.DisplayObjectContainer,this.othercontain.addChild(this.playcontain),this.playinfo();var n=new GameUtil.Menu(this,"closebtn_png","closebtn_png",this.closecontain);n.x=653,n.y=482,this.othercontain.addChild(n)},n.setting=function(){console.log("setting"),this.switchbtn=[],this.createContain();var t=new GameUtil.MyBitmap(RES.getRes("settingbg_png"),this.mStageW/2,618);this.othercontain.addChild(t);for(var e=0;2>e;e++){var i=new GameUtil.MyBitmap(RES.getRes("settingswitch_png"),524,567+108*e);this.othercontain.addChild(i),this.switchbtn[e]=new GameUtil.Menu(this,"settingswitchon_png","settingswitchon_png",this.settingswitch,[e,i]),this.switchbtn[e].x=488,this.switchbtn[e].y=566+108*e,this.othercontain.addChild(this.switchbtn[e]),this.othercontain.swapChildren(i,this.switchbtn[e])}var n=new GameUtil.Menu(this,"closebtn_png","closebtn_png",this.closecontain);n.x=606,n.y=472,this.othercontain.addChild(n)},n.share=function(){console.log("share"),this.createContain();var t=new GameUtil.MyBitmap(RES.getRes("sharebg_png"),this.mStageW/2,this.mStageH/2);this.othercontain.addChild(t);var e="http://bubblefight.h5.gamexun.com/?shareopenid="+GameData._i().UserInfo.openid,i=qr.QRCode.create(e,0,180,180);i.x=135,i.y=594,this.othercontain.addChild(i);var n=new GameUtil.Menu(this,"sharecordbtn_png","sharecordbtn_png",this.sharegame);n.setScaleMode(),n.x=230,n.y=818,this.othercontain.addChild(n);var a=new GameUtil.Menu(this,"closebtn_png","closebtn_png",this.closecontain);a.x=653,a.y=482,this.othercontain.addChild(a)},n.shop=function(){console.log("shop");var t={openid:GameData._i().UserInfo.openid};GameUtil.Http.getinstance().send(t,"/paopao/getmypack",this.getshop,this)},n.getshop=function(t){if(1==t.code){for(var e=t.result,i=0;i<e.length;i++)1==e[i].propstype?(console.log(GameData._i().PlayerHadrole.indexOf(parseInt(e[i].propsname))),GameData._i().PlayerHadrole.indexOf(parseInt(e[i].propsname))<0&&GameData._i().PlayerHadrole.push(parseInt(e[i].propsname))):GameData._i().PlayerHadtool.indexOf(parseInt(e[i].propsname))<0&&GameData._i().PlayerHadtool.push(parseInt(e[i].propsname));this.createContain();var n=new GameUtil.MyBitmap(RES.getRes("shopbg_png"),this.mStageW/2,708);this.othercontain.addChild(n),this.shopbagcontain=new egret.DisplayObjectContainer,this.othercontain.addChild(this.shopbagcontain);var a=new GameUtil.Menu(this,"rolebtn_png","rolebtn_png",this.showshopbagrole);a.x=197,a.y=441,a.setScaleMode(),this.othercontain.addChild(a);var r=new GameUtil.Menu(this,"toolbtn_png","toolbtn_png",this.showshopbagtool);r.x=368,r.y=441,r.setScaleMode(),this.othercontain.addChild(r),this.showshopbagrole();var s=new GameUtil.Menu(this,"closebtn_png","closebtn_png",this.closecontain);s.x=664,s.y=410,this.othercontain.addChild(s)}else console.log(t.msg)},n.createContain=function(){this.othercontain=new egret.DisplayObjectContainer,this.addChild(this.othercontain),this.othercontain.touchEnabled=!0;var t=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.6);this.othercontain.addChild(t)},n.closecontain=function(){egret.Tween.removeAllTweens(),this.removeChild(this.othercontain),this.othercontain=null},n.runluckpoint=function(){if(this.activerunluck){this.activerunluck=!1;var t=this;this.othercontain.getChildByName("lucktiptext")&&this.othercontain.removeChild(this.othercontain.getChildByName("lucktiptext"));var e=RandomUtils.randomArray([2,5,8]),i=this.getrotatag(e)+720,n=i;egret.Tween.get(this.luckpoint).to({rotation:i},n,egret.Ease.sineInOut).call(t.sendluckresult,this,[e])}},n.sendluckresult=function(t){console.log("rota=====",t);var e=t,i=[100,30,1,10,100,5,50,20,2,50],n=["100泡泡","30元话费","1泡泡","10泡泡","100元话费","5泡泡","50泡泡","20泡泡","2泡泡","50元话费"];this.getbubblecount=i[e];var a={openid:GameData._i().UserInfo.openid,prizename:n[e],paopaocount:i[e]};GameUtil.Http.getinstance().send(a,"/paopao/addprize",this.addprizeresult,this)},n.addprizeresult=function(t){if(this.activerunluck=!0,1==t.code){var e=new GameUtil.MyTextField(this.mStageW/2,1080,50);e.name="lucktiptext",e.setText("恭喜您，获得了"+this.getbubblecount+"个泡泡"),e.textColor=16141124,this.othercontain.addChild(e),GameData._i().UserInfo.prizecount-=1,this.freecountT.setText("免费抽奖次数:"+GameData._i().UserInfo.prizecount+"/3"),0==GameData._i().UserInfo.prizecount&&(GameUtil.changeGray(this.luckpoint),this.luckpoint.$setTouchEnabled(!1))}else{console.log(t.msg);var e=new GameUtil.MyTextField(this.mStageW/2,1080,50);e.name="lucktiptext",e.setText(t.msg),e.textColor=16141124,this.othercontain.addChild(e)}},n.playinfo=function(){this.playcontain.removeChildren();var t=new GameUtil.MyBitmap(RES.getRes("roletype_"+GameData._i().PlayerRoleType+"_png"),185,683);this.playcontain.addChild(t);for(var e=["ID:","名字:","泡泡:","总积分:","总击杀:","被杀:"],i=[""+GameData._i().UserInfo.ID,GameData._i().UserInfo.nickname,""+GameData._i().PlayerBubbleNumber,""+GameData._i().UserInfo.jifen,""+GameData._i().UserInfo.killcount,""+GameData._i().UserInfo.bekillcount],n=0;6>n;n++){var a=new GameUtil.MyTextField(340,600+35*n,30,0);a.setText(e[n]),a.textColor=8880072,this.playcontain.addChild(a);var r=new GameUtil.MyTextField(450,600+35*n,30,0);r.setText(i[n]),r.textColor=8880072,this.playcontain.addChild(r)}},n.playbag=function(){var t={openid:GameData._i().UserInfo.openid};GameUtil.Http.getinstance().send(t,"/paopao/getmypack",this.getplayerbag,this)},n.getplayerbag=function(t){if(1==t.code){var e=t.result;this.playcontain.removeChildren(),this.bagcontain=new egret.DisplayObjectContainer,this.playcontain.addChild(this.bagcontain);for(var i=0;i<e.length;i++)1==e[i].propstype?GameData._i().PlayerHadrole.indexOf(parseInt(e[i].propsname))<0&&GameData._i().PlayerHadrole.push(parseInt(e[i].propsname)):GameData._i().PlayerHadtool.indexOf(parseInt(e[i].propsname))<0&&GameData._i().PlayerHadtool.push(parseInt(e[i].propsname));var n=new GameUtil.Menu(this,"rolebtn_png","rolebtn_png",this.showrole);n.x=192,n.y=640,n.setScaleMode(),this.playcontain.addChild(n);var a=new GameUtil.Menu(this,"toolbtn_png","toolbtn_png",this.showtool);a.x=192,a.y=746,a.setScaleMode(),this.playcontain.addChild(a),this.showrole()}else console.log(t.msg)},n.showrole=function(){this.bagcontain.removeChildren();for(var t=0;t<GameData._i().PlayerHadrole.length;t++){var e="hadroletype_"+GameData._i().PlayerHadrole[t]+"_png",i=new GameUtil.Menu(this,e,e,this.showrolemenu,[GameData._i().PlayerHadrole[t],t]);i.x=370+105*(t%3),i.y=635+110*Math.floor(t/3),this.bagcontain.addChild(i)}},n.showtool=function(){this.bagcontain.removeChildren();for(var t=0;t<GameData._i().PlayerHadtool.length;t++){var e="shopselftool_"+GameData._i().PlayerHadtool[t]+"_png",i=new GameUtil.Menu(this,e,e,this.showtoolmenu,[GameData._i().PlayerHadtool[t],t]);i.x=367+106*(t%3),i.y=636+110*Math.floor(t/3),i.$setScaleX(.8),i.$setScaleY(.8),this.bagcontain.addChild(i)}},n.sharegame=function(){var t=new egret.DisplayObjectContainer;this.addChild(t);var e=this,i=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.6);t.addChild(i),i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.removeChild(t)},this);var n=new GameUtil.MyBitmap(RES.getRes("sharetip_png"),this.mStageW,0);n.setanchorOff(1,0),t.addChild(n)},n.showshopbagrole=function(){this.shopbagcontain.removeChildren();for(var t=["皮皮:50泡泡","妞妞:80泡泡","琪琪:100泡泡","明明:120泡泡","聪聪:140泡泡","跳跳:160泡泡"],e=0;6>e;e++){var i="shopself_"+e+"_png",n=new GameUtil.Menu(this,i,i,this.buyrole,[e]);n.x=193+e%3*173,n.y=578+254*Math.floor(e/3),this.shopbagcontain.addChild(n);var a=new GameUtil.MyTextField(n.x,700+254*Math.floor(e/3),25);a.width=113,a.textAlign=egret.HorizontalAlign.CENTER,a.setText(t[e]),a.textColor=16777215,this.shopbagcontain.addChild(a);for(var r=0;r<GameData._i().PlayerHadrole.length;r++)if(e==GameData._i().PlayerHadrole[r]){a.setText("已拥有"),a.textColor=1742245,n.touchEnabled=!1;break}}},n.showshopbagtool=function(){this.shopbagcontain.removeChildren();for(var t=["蓝色泡泡:50泡泡","黄色泡泡:80泡泡","红包泡泡:100泡泡","紫色泡泡:120泡泡","彩色泡泡:130泡泡","骷髅泡泡:150泡泡"],e=0;6>e;e++){var i="shopselftool_"+e+"_png",n=new GameUtil.Menu(this,i,i,this.buytool,[e]);n.x=195+e%3*175,n.y=578+254*Math.floor(e/3),this.shopbagcontain.addChild(n);var a=new GameUtil.MyTextField(n.x,700+254*Math.floor(e/3),25);a.width=113,a.textAlign=egret.HorizontalAlign.CENTER,a.setText(t[e]),a.textColor=16777215,this.shopbagcontain.addChild(a);for(var r=0;r<GameData._i().PlayerHadtool.length;r++)if(e==GameData._i().PlayerHadtool[r]){a.setText("已拥有"),a.textColor=1742245,n.touchEnabled=!1;break}}},n.buyrole=function(t){console.log("roleid======",t);var e=new egret.DisplayObjectContainer;e.name="tipcontain",this.othercontain.addChild(e),e.touchEnabled=!0;var i=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.4);e.addChild(i);var n=new GameUtil.MyBitmap(RES.getRes("shoptip_png"),this.mStageW/2,855);e.addChild(n);var a="shopself_"+t+"_png",r=new GameUtil.MyBitmap(RES.getRes(a),this.mStageW/2,785);e.addChild(r);var s=["皮皮","妞妞","琪琪","明明","聪聪","跳跳"],o=this.burolecount,h=new GameUtil.MyTextField(this.mStageW/2,905,30);h.textAlign=egret.HorizontalAlign.CENTER,h.width=355,h.setText("是否消耗"+o[t]+"泡泡领取"+s[t]),h.textColor=8022400,e.addChild(h);var l=new GameUtil.Menu(this,"buybtn_png","buybtn_png",this.getrole,[t]);l.x=this.mStageW/2,l.y=977,l.setScaleMode(),e.addChild(l);var c=new GameUtil.Menu(this,"closebtn_png","closebtn_png",function(){e.parent.removeChild(e)});c.x=572,c.y=717,e.addChild(c)},n.buytool=function(t){console.log("toolid=====",t);var e=new egret.DisplayObjectContainer;e.name="tipcontain",this.othercontain.addChild(e),e.touchEnabled=!0;var i=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.4);e.addChild(i);var n=new GameUtil.MyBitmap(RES.getRes("shoptip_png"),this.mStageW/2,855);e.addChild(n);var a="shopselftool_"+t+"_png",r=new GameUtil.MyBitmap(RES.getRes(a),this.mStageW/2,785);e.addChild(r);var s=["蓝色泡泡","黄色泡泡","红包泡泡","紫色泡泡","彩色泡泡","骷髅泡泡"],o=this.butoolcount,h=new GameUtil.MyTextField(this.mStageW/2,905,30);h.textAlign=egret.HorizontalAlign.CENTER,h.width=355,h.setText("是否消耗"+o[t]+"泡泡领取"+s[t]),h.textColor=8022400,e.addChild(h);var l=new GameUtil.Menu(this,"buybtn_png","buybtn_png",this.gettool,[t]);l.x=this.mStageW/2,l.y=977,l.setScaleMode(),e.addChild(l);var c=new GameUtil.Menu(this,"closebtn_png","closebtn_png",function(){e.parent.removeChild(e)});c.x=572,c.y=717,e.addChild(c)},n.getrole=function(t){var e=this.burolecount;if(GameData._i().PlayerBubbleNumber<e[t])this.addChild(new GameUtil.TipsPanel(null,"泡泡数不够",!0));else{console.log("买买买角色=====",t),this.buyroleortoolID=t;var i={openid:GameData._i().UserInfo.openid,propstype:1,propsname:""+t,paopaocount:e[t]};GameUtil.Http.getinstance().send(i,"/paopao/buyprops",this.getrolesuccess,this)}},n.getrolesuccess=function(t){if(1==t.code){var e=this.burolecount;GameData._i().PlayerHadrole.push(this.buyroleortoolID),GameData._i().PlayerBubbleNumber-=e[this.buyroleortoolID],this.othercontain.removeChild(this.othercontain.getChildByName("tipcontain")),this.showshopbagrole()}else console.log(t.msg)},n.gettool=function(t){var e=this.butoolcount;if(GameData._i().PlayerBubbleNumber<e[t])this.addChild(new GameUtil.TipsPanel(null,"泡泡数不够",!0));else{console.log("买买买道具"),this.buyroleortoolID=t;var i={openid:GameData._i().UserInfo.openid,propstype:1,propsname:""+t,paopaocount:e[t]};GameUtil.Http.getinstance().send(i,"/paopao/buyprops",this.gettoolsuccess,this)}},n.gettoolsuccess=function(t){if(1==t.code){var e=this.butoolcount;GameData._i().PlayerHadtool.push(this.buyroleortoolID),GameData._i().PlayerBubbleNumber-=e[this.buyroleortoolID],this.othercontain.removeChild(this.othercontain.getChildByName("tipcontain")),this.showshopbagtool()}else console.log(t.msg)},n.settingswitch=function(t,e){this.soundswitch[t]=!this.soundswitch[t],e.x=this.soundswitch[t]?524:452;var i=this.soundswitch[t]?"settingswitchon_png":"settingswitchoff_png";this.switchbtn[t].setButtonTexture(i,i)},n.showotherinfo=function(t){console.log("id====",t);var e={openid:t};GameUtil.Http.getinstance().send(e,"/paopao/getuserinfo",this.getotherinfo,this)},n.getotherinfo=function(t){if(1==t.code){var e=t.result,i=new egret.DisplayObjectContainer;this.othercontain.addChild(i);var n=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.6);i.addChild(n),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.parent.removeChild(i)},this);var a=new GameUtil.MyBitmap(RES.getRes("showinfobg_png"),this.mStageW/2,this.mStageH/2);i.addChild(a);var r=new GameUtil.MyBitmap(RES.getRes("showinforight_png"),196,this.mStageH/2);i.addChild(r);var s=new GameUtil.MyBitmap(RES.getRes("showinfoleft_png"),479,this.mStageH/2);i.addChild(s);var o=new GameUtil.MyBitmap(RES.getRes("roletype_"+GameData._i().PlayerRoleType+"_png"),185,this.mStageH/2);i.addChild(o);for(var h=["ID:","名字:","泡泡:","总积分:","总击杀:","被杀:"],l=[""+e.openid,e.nickname,""+e.paopaocount,""+e.jifen,""+e.killcount,""+e.bekillcount],c=0;6>c;c++){var u=new GameUtil.MyTextField(340,580+35*c,30,0);u.setText(h[c]),u.textColor=8880072,i.addChild(u);var d=new GameUtil.MyTextField(450,580+35*c,30,0);d.setText(l[c]),d.textColor=8880072,i.addChild(d)}}else console.log(t.msg)},n.showrolemenu=function(t,e){if(GameData._i().PlayerRoleType!=t){var i=new egret.DisplayObjectContainer;this.othercontain.addChild(i);var n=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.6);i.addChild(n),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.parent.removeChild(i)},this);var a=370+105*(e%3),r=635+110*Math.floor(e/3),s=new GameUtil.Menu(this,null,null,this.usenewrole,[t,i],GameUtil.createRect(a,r,100,50,1,16777215));s.addButtonText("使用",40,a+50,r+25),i.addChild(s)}},n.showtoolmenu=function(t,e){if(GameData._i().PlayerToolType!=t){var i=new egret.DisplayObjectContainer;this.othercontain.addChild(i);var n=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.6);i.addChild(n),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.parent.removeChild(i)},this);var a=367+106*(e%3),r=636+110*Math.floor(e/3),s=new GameUtil.Menu(this,null,null,this.usenewtool,[t,i],GameUtil.createRect(a,r,100,50,1,16777215));s.addButtonText("使用",40,a+50,r+25),i.addChild(s)}},n.usenewrole=function(t,e){GameData._i().PlayerRoleType=t,e.parent.removeChild(e)},n.usenewtool=function(t,e){GameData._i().PlayerToolType=t,e.parent.removeChild(e)},n.getrotatag=function(t){switch(t){case 0:return RandomUtils.limit(10,36);case 1:return RandomUtils.limit(37,63);case 2:return RandomUtils.limit(66,112);case 3:return RandomUtils.limit(113,139);case 4:return RandomUtils.limit(140,155);case 5:return RandomUtils.limit(168,201);case 6:return RandomUtils.limit(202,241);case 7:return RandomUtils.limit(242,296);case 8:return RandomUtils.limit(304,333);case 9:return RandomUtils.limit(334,370)}},e}(GameUtil.BassPanel);egret.registerClass(StartGameScene,"StartGameScene");var qr;!function(t){var e=function(){function e(e){this.mode=t.QRMode.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var i=0,n=this.data.length;n>i;i++){var a=[],r=this.data.charCodeAt(i);r>65536?(a[0]=240|(1835008&r)>>>18,a[1]=128|(258048&r)>>>12,a[2]=128|(4032&r)>>>6,a[3]=128|63&r):r>2048?(a[0]=224|(61440&r)>>>12,a[1]=128|(4032&r)>>>6,a[2]=128|63&r):r>128?(a[0]=192|(1984&r)>>>6,a[1]=128|63&r):a[0]=r,this.parsedData.push(a)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}var i=(__define,e),n=i.prototype;return n.getLength=function(t){return this.parsedData.length},n.write=function(t){for(var e=0,i=this.parsedData.length;i>e;e++)t.put(this.parsedData[e],8)},e}();t.QR8bitByte=e,egret.registerClass(e,"qr.QR8bitByte")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){this.buffer=[],this.length=0}var e=(__define,t),i=e.prototype;return i.get=function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},i.put=function(t,e){for(var i=0;e>i;i++)this.putBit(1==(t>>>e-i-1&1))},i.getLengthInBits=function(){return this.length},i.putBit=function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++
},t}();t.QRBitBuffer=e,egret.registerClass(e,"qr.QRBitBuffer")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var i=0;i<t.length&&0==t[i];)i++;this.num=new Array(t.length-i+e);for(var n=0;n<t.length-i;n++)this.num[n]=t[n+i]}var i=(__define,e),n=i.prototype;return n.get=function(t){return this.num[t]},n.getLength=function(){return this.num.length},n.multiply=function(i){for(var n=new Array(this.getLength()+i.getLength()-1),a=0;a<this.getLength();a++)for(var r=0;r<i.getLength();r++)n[a+r]^=t.QRMath.gexp(t.QRMath.glog(this.get(a))+t.QRMath.glog(i.get(r)));return new e(n,0)},n.mod=function(i){if(this.getLength()-i.getLength()<0)return this;for(var n=t.QRMath.glog(this.get(0))-t.QRMath.glog(i.get(0)),a=new Array(this.getLength()),r=0;r<this.getLength();r++)a[r]=this.get(r);for(var r=0;r<i.getLength();r++)a[r]^=t.QRMath.gexp(t.QRMath.glog(i.get(r))+n);return new e(a,0).mod(i)},e}();t.QRPolynomial=e,egret.registerClass(e,"qr.QRPolynomial")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}var i=(__define,e);i.prototype;return e.create=function(i,n,a,r,s){void 0===n&&(n=0),void 0===a&&(a=200),void 0===r&&(r=200),void 0===s&&(s=2);var o={width:a,height:r,correctLevel:t.QRErrorCorrectLevel.H,color:n},h=new t.QRCodeModel(t.QRUtil._getTypeNumber(i,o.correctLevel),o.correctLevel);return h.addData(i),h.make(),e.draw(h,o)},e.draw=function(t,e){for(var i=new egret.Sprite,e=e,n=t.getModuleCount(),a=Math.floor(e.width/n),r=Math.floor(e.height/n),s=0;n>s;s++)for(var o=0;n>o;o++){var h=t.isDark(s,o);h&&(i.graphics.beginFill(e.color),i.graphics.drawRect(o*a,s*r,a,r),i.graphics.endFill())}return i},e}();t.QRCode=e,egret.registerClass(e,"qr.QRCode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[],this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var i=(__define,e),n=i.prototype;return n.addData=function(e){var i=new t.QR8bitByte(e);this.dataList.push(i),this.dataCache=null},n.isDark=function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},n.getModuleCount=function(){return this.moduleCount},n.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},n.makeImpl=function(t,i){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=new Array(this.moduleCount);for(var a=0;a<this.moduleCount;a++)this.modules[n][a]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,i),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,i)},n.setupPositionProbePattern=function(t,e){for(var i=-1;7>=i;i++)if(!(-1>=t+i||this.moduleCount<=t+i))for(var n=-1;7>=n;n++)-1>=e+n||this.moduleCount<=e+n||(i>=0&&6>=i&&(0==n||6==n)||n>=0&&6>=n&&(0==i||6==i)||i>=2&&4>=i&&n>=2&&4>=n?this.modules[t+i][e+n]=!0:this.modules[t+i][e+n]=!1)},n.getBestMaskPattern=function(){for(var e=0,i=0,n=0;8>n;n++){this.makeImpl(!0,n);var a=t.QRUtil.getLostPoint(this);(0==n||e>a)&&(e=a,i=n)}return i},n.createMovieClip=function(t,e,i){var n=t.createEmptyMovieClip(e,i),a=1;this.make();for(var r=0;r<this.modules.length;r++)for(var s=r*a,o=0;o<this.modules[r].length;o++){var h=o*a,l=this.modules[r][o];l&&(n.beginFill(0,100),n.moveTo(h,s),n.lineTo(h+a,s),n.lineTo(h+a,s+a),n.lineTo(h,s+a),n.endFill())}return n},n.setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},n.setupPositionAdjustPattern=function(){for(var e=t.QRUtil.getPatternPosition(this.typeNumber),i=0;i<e.length;i++)for(var n=0;n<e.length;n++){var a=e[i],r=e[n];if(null==this.modules[a][r])for(var s=-2;2>=s;s++)for(var o=-2;2>=o;o++)-2==s||2==s||-2==o||2==o||0==s&&0==o?this.modules[a+s][r+o]=!0:this.modules[a+s][r+o]=!1}},n.setupTypeNumber=function(e){for(var i=t.QRUtil.getBCHTypeNumber(this.typeNumber),n=0;18>n;n++){var a=!e&&1==(i>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=a}for(var n=0;18>n;n++){var a=!e&&1==(i>>n&1);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=a}},n.setupTypeInfo=function(e,i){for(var n=this.errorCorrectLevel<<3|i,a=t.QRUtil.getBCHTypeInfo(n),r=0;15>r;r++){var s=!e&&1==(a>>r&1);6>r?this.modules[r][8]=s:8>r?this.modules[r+1][8]=s:this.modules[this.moduleCount-15+r][8]=s}for(var r=0;15>r;r++){var s=!e&&1==(a>>r&1);8>r?this.modules[8][this.moduleCount-r-1]=s:9>r?this.modules[8][15-r-1+1]=s:this.modules[8][15-r-1]=s}this.modules[this.moduleCount-8][8]=!e},n.mapData=function(e,i){for(var n=-1,a=this.moduleCount-1,r=7,s=0,o=this.moduleCount-1;o>0;o-=2)for(6==o&&o--;;){for(var h=0;2>h;h++)if(null==this.modules[a][o-h]){var l=!1;s<e.length&&(l=1==(e[s]>>>r&1));var c=t.QRUtil.getMask(i,a,o-h);c&&(l=!l),this.modules[a][o-h]=l,r--,-1==r&&(s++,r=7)}if(a+=n,0>a||this.moduleCount<=a){a-=n,n=-n;break}}},e.createData=function(i,n,a){for(var r=t.QRRSBlock.getRSBlocks(i,n),s=new t.QRBitBuffer,o=0;o<a.length;o++){var h=a[o];s.put(h.mode,4),s.put(h.getLength(),t.QRUtil.getLengthInBits(h.mode,i)),h.write(s)}for(var l=0,o=0;o<r.length;o++)l+=r[o].dataCount;if(s.getLengthInBits()>8*l)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*l+")");for(s.getLengthInBits()+4<=8*l&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;!(s.getLengthInBits()>=8*l)&&(s.put(e.PAD0,8),!(s.getLengthInBits()>=8*l));)s.put(e.PAD1,8);return e.createBytes(s,r)},e.createBytes=function(e,i){for(var n=0,a=0,r=0,s=new Array(i.length),o=new Array(i.length),h=0;h<i.length;h++){var l=i[h].dataCount,c=i[h].totalCount-l;a=Math.max(a,l),r=Math.max(r,c),s[h]=new Array(l);for(var u=0;u<s[h].length;u++)s[h][u]=255&e.buffer[u+n];n+=l;var d=t.QRUtil.getErrorCorrectPolynomial(c),g=new t.QRPolynomial(s[h],d.getLength()-1),m=g.mod(d);o[h]=new Array(d.getLength()-1);for(var u=0;u<o[h].length;u++){var p=u+m.getLength()-o[h].length;o[h][u]=p>=0?m.get(p):0}}for(var f=0,u=0;u<i.length;u++)f+=i[u].totalCount;for(var v=new Array(f),b=0,u=0;a>u;u++)for(var h=0;h<i.length;h++)u<s[h].length&&(v[b++]=s[h][u]);for(var u=0;r>u;u++)for(var h=0;h<i.length;h++)u<o[h].length&&(v[b++]=o[h][u]);return v},e.PAD0=236,e.PAD1=17,e}();t.QRCodeModel=e,egret.registerClass(e,"qr.QRCodeModel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.L=1,t.M=0,t.Q=3,t.H=2,t}();t.QRErrorCorrectLevel=e,egret.registerClass(e,"qr.QRErrorCorrectLevel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.PATTERN000=0,t.PATTERN001=1,t.PATTERN010=2,t.PATTERN011=3,t.PATTERN100=4,t.PATTERN101=5,t.PATTERN110=6,t.PATTERN111=7,t}();t.QRMaskPattern=e,egret.registerClass(e,"qr.QRMaskPattern")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.glog=function(e){return t.isInit||t.init(),1>e&&console.log("错误:n="+e),t.LOG_TABLE[e]},t.gexp=function(e){for(t.isInit||t.init();0>e;)e+=255;for(;e>=256;)e-=255;return t.EXP_TABLE[e]},t.init=function(){t.isInit=!0;for(var e=0;8>e;e++)t.EXP_TABLE[e]=1<<e;for(var e=8;256>e;e++)t.EXP_TABLE[e]=t.EXP_TABLE[e-4]^t.EXP_TABLE[e-5]^t.EXP_TABLE[e-6]^t.EXP_TABLE[e-8];for(var e=0;255>e;e++)t.LOG_TABLE[t.EXP_TABLE[e]]=e},t.EXP_TABLE=new Array(256),t.LOG_TABLE=new Array(256),t}();t.QRMath=e,egret.registerClass(e,"qr.QRMath")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.MODE_NUMBER=1,t.MODE_ALPHA_NUM=2,t.MODE_8BIT_BYTE=4,t.MODE_KANJI=8,t}();t.QRMode=e,egret.registerClass(e,"qr.QRMode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){this.totalCount=t,this.dataCount=e}var i=(__define,e);i.prototype;return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(t,i){var n=e.getRsBlockTable(t,i);if(void 0==n)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+i);for(var a=n.length/3,r=[],s=0;a>s;s++)for(var o=n[3*s+0],h=n[3*s+1],l=n[3*s+2],c=0;o>c;c++)r.push(new e(h,l));return r},e.getRsBlockTable=function(i,n){switch(n){case t.QRErrorCorrectLevel.L:return e.RS_BLOCK_TABLE[4*(i-1)+0];case t.QRErrorCorrectLevel.M:return e.RS_BLOCK_TABLE[4*(i-1)+1];case t.QRErrorCorrectLevel.Q:return e.RS_BLOCK_TABLE[4*(i-1)+2];case t.QRErrorCorrectLevel.H:return e.RS_BLOCK_TABLE[4*(i-1)+3];default:return}},e}();t.QRRSBlock=e,egret.registerClass(e,"qr.QRRSBlock")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}var i=(__define,e),n=i.prototype;return e.getBCHTypeInfo=function(t){for(var i=t<<10;e.getBCHDigit(i)-e.getBCHDigit(e.G15)>=0;)i^=e.G15<<e.getBCHDigit(i)-e.getBCHDigit(e.G15);return(t<<10|i)^e.G15_MASK},e.getBCHTypeNumber=function(t){for(var i=t<<12;e.getBCHDigit(i)-e.getBCHDigit(e.G18)>=0;)i^=e.G18<<e.getBCHDigit(i)-e.getBCHDigit(e.G18);return t<<12|i},e.getBCHDigit=function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},e.getPatternPosition=function(t){return e.PATTERN_POSITION_TABLE[t-1]},e.getMask=function(e,i,n){switch(e){case t.QRMaskPattern.PATTERN000:return(i+n)%2==0;case t.QRMaskPattern.PATTERN001:return i%2==0;case t.QRMaskPattern.PATTERN010:return n%3==0;case t.QRMaskPattern.PATTERN011:return(i+n)%3==0;case t.QRMaskPattern.PATTERN100:return(Math.floor(i/2)+Math.floor(n/3))%2==0;case t.QRMaskPattern.PATTERN101:return i*n%2+i*n%3==0;case t.QRMaskPattern.PATTERN110:return(i*n%2+i*n%3)%2==0;case t.QRMaskPattern.PATTERN111:return(i*n%3+(i+n)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},e.getErrorCorrectPolynomial=function(e){for(var i=new t.QRPolynomial([1],0),n=0;e>n;n++)i=i.multiply(new t.QRPolynomial([1,t.QRMath.gexp(n)],0));return i},e.getLengthInBits=function(e,i){if(i>=1&&10>i)switch(e){case t.QRMode.MODE_NUMBER:return 10;case t.QRMode.MODE_ALPHA_NUM:return 9;case t.QRMode.MODE_8BIT_BYTE:return 8;case t.QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(27>i)switch(e){case t.QRMode.MODE_NUMBER:return 12;case t.QRMode.MODE_ALPHA_NUM:return 11;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(41>i))throw new Error("type:"+i);switch(e){case t.QRMode.MODE_NUMBER:return 14;case t.QRMode.MODE_ALPHA_NUM:return 13;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},e.getLostPoint=function(t){for(var e=t.getModuleCount(),i=0,n=0;e>n;n++)for(var a=0;e>a;a++){for(var r=0,s=t.isDark(n,a),o=-1;1>=o;o++)if(!(0>n+o||n+o>=e))for(var h=-1;1>=h;h++)0>a+h||a+h>=e||(0!=o||0!=h)&&s==t.isDark(n+o,a+h)&&r++;r>5&&(i+=3+r-5)}for(var n=0;e-1>n;n++)for(var a=0;e-1>a;a++){var l=0;t.isDark(n,a)&&l++,t.isDark(n+1,a)&&l++,t.isDark(n,a+1)&&l++,t.isDark(n+1,a+1)&&l++,(0==l||4==l)&&(i+=3)}for(var n=0;e>n;n++)for(var a=0;e-6>a;a++)t.isDark(n,a)&&!t.isDark(n,a+1)&&t.isDark(n,a+2)&&t.isDark(n,a+3)&&t.isDark(n,a+4)&&!t.isDark(n,a+5)&&t.isDark(n,a+6)&&(i+=40);for(var a=0;e>a;a++)for(var n=0;e-6>n;n++)t.isDark(n,a)&&!t.isDark(n+1,a)&&t.isDark(n+2,a)&&t.isDark(n+3,a)&&t.isDark(n+4,a)&&!t.isDark(n+5,a)&&t.isDark(n+6,a)&&(i+=40);for(var c=0,a=0;e>a;a++)for(var n=0;e>n;n++)t.isDark(n,a)&&c++;var u=Math.abs(100*c/e/e-50)/5;return i+=10*u},n.static_isSupportCanvas=function(){return"undefined"!=typeof CanvasRenderingContext2D},e._getTypeNumber=function(i,n){for(var a=1,r=e._getUTF8Length(i),s=0,o=e.QRCodeLimitLength.length;o>=s;s++){var h=0;switch(n){case t.QRErrorCorrectLevel.L:h=e.QRCodeLimitLength[s][0];break;case t.QRErrorCorrectLevel.M:h=e.QRCodeLimitLength[s][1];break;case t.QRErrorCorrectLevel.Q:h=e.QRCodeLimitLength[s][2];break;case t.QRErrorCorrectLevel.H:h=e.QRCodeLimitLength[s][3]}if(h>=r)break;a++}if(a>e.QRCodeLimitLength.length)throw new Error("Too long data");return a},e._getUTF8Length=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)},e.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],e.G15=1335,e.G18=7973,e.G15_MASK=21522,e.QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],e}();t.QRUtil=e,egret.registerClass(e,"qr.QRUtil")}(qr||(qr={}));