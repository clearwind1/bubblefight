var GameUtil;!function(t){var e=function(t){function e(e,i,a){t.call(this),this.init(e,i,a)}__extends(e,t);var i=(__define,e),a=i.prototype;return a.init=function(t,e,i){this.texture=t,this.$setX(e),this.$setY(i),this.setanchorOff(.5,.5)},a.setNewTexture=function(t){this.texture=t},a.setanchorOff=function(t,e){this.anchorOffsetX=this.$getWidth()*t,this.anchorOffsetY=this.$getHeight()*e},e}(egret.Bitmap);t.MyBitmap=e,egret.registerClass(e,"GameUtil.MyBitmap")}(GameUtil||(GameUtil={}));var BombSprite=function(t){function e(e,i,a,n){t.call(this,e,i,a),this.isbomed=!1,this.isplayerb=!1,this.bompower=1,this.start(),this.isplayerb=n}__extends(e,t);var i=(__define,e),a=i.prototype;return a.initdata=function(){this.gamecontain=this.parent.parent,this.parcontain=this.parent},a.start=function(){var t=this;this.tw=egret.Tween.get(this,{loop:!0}).to({scaleX:.9,scaleY:.9}).to({scaleX:1,scaleY:1},400),this.titag=egret.setTimeout(t.bomb,this,3e3)},a.bomb=function(){GameData._i().gamesound[SoundName.bombsound].play(0,1),egret.clearTimeout(this.titag),this.tw.loop=!1,egret.Tween.removeTweens(this.tw),this.visible=!1,this.parcontain.removeChild(this);var t=this.gamecontain.bombarr.indexOf(this);this.gamecontain.bombarr.splice(t,1);var e=this.parcontain;this.bombefl=new GameUtil.MyBitmap(RES.getRes("bombeffectl_png"),this.x,this.y),this.bombefl.$setScaleX(0),e.addChild(this.bombefl),this.gamecontain.bomeffectarr.push(this.bombefl),this.bombefp=new GameUtil.MyBitmap(RES.getRes("bombeffectp_png"),this.x,this.y),this.bombefp.$setScaleY(0),e.addChild(this.bombefp),this.gamecontain.bomeffectarr.push(this.bombefp),egret.Tween.get(this.bombefl).to({scaleX:this.bompower},200),egret.Tween.get(this.bombefp).to({scaleY:this.bompower},200).call(this.checkhit,this)},a.checkhit=function(){var t=this.gamecontain;if(this.isbomed=!0,GameData._i().GameOver){if(null==this.parcontain)return;egret.clearTimeout(this.titag),this.tw.loop=!1,egret.Tween.removeTweens(this.tw),this.parcontain.removeChild(this.bombefl),this.parcontain.removeChild(this.bombefp);var e=t.bomeffectarr.indexOf(this.bombefl);t.bomeffectarr.splice(e,1);var i=t.bomeffectarr.indexOf(this.bombefp);return void t.bomeffectarr.splice(i,1)}for(var a=0;a<t.bombarr.length;a++){var n=t.bombarr[a],s=this.getrect(n,1,1),o=this.getrect(this.bombefl,this.bombefl.scaleX,this.bombefl.scaleY),r=this.getrect(this.bombefp,this.bombefp.scaleX,this.bombefp.scaleY);(s.intersects(o)||s.intersects(r))&&n.bomb()}for(var a=0;a<t.rolearr.length;a++){var s=this.getrect(t.rolearr[a],.9,.9),o=this.getrect(this.bombefl,this.bombefl.scaleX,this.bombefl.scaleY),r=this.getrect(this.bombefp,this.bombefp.scaleX,this.bombefp.scaleY),h=t.rolearr[a];h.isSuperstate||!s.intersects(o)&&!s.intersects(r)||t.rolearr[a].die(this.isplayerb)}this.parcontain.removeChild(this.bombefl),this.parcontain.removeChild(this.bombefp);var e=t.bomeffectarr.indexOf(this.bombefl);t.bomeffectarr.splice(e,1);var i=t.bomeffectarr.indexOf(this.bombefp);t.bomeffectarr.splice(i,1)},a.getrect=function(t,e,i){var a=t.getBounds();return a.x=t.x-t.width*e/2,a.y=t.y-t.height*i/2,a.width=t.width*e,a.height=t.height*i,a},e}(GameUtil.MyBitmap);egret.registerClass(BombSprite,"BombSprite");var Dircontorllayer=function(t){function e(e,i,a,n,s){t.call(this,e,i,a)}__extends(e,t);var i=(__define,e),a=i.prototype;return a.initobj=function(t,e){var i=this.parent;this.playerrole=e,this.touchID=t,this.touchEnabled=!0,this.active=!1,i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.DirTouchBegin,this),i.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.DirTouchMove,this),i.addEventListener(egret.TouchEvent.TOUCH_END,this.DirTouchEnd,this),i.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.DirTouchCancel,this)},a.DirTouchBegin=function(t){if(!this.active)if(this.active=!0,4==this.touchID);else for(var e=this.parent.parent,i=0;i<e.controldirarr.length;i++){var a=e.controldirarr[i],n=parseInt(a.name);if(-1!=n&&a.hitTestPoint(t.$stageX,t.stageY)){this.touchID=n,this.playerrole.startmove(this.touchID);break}}},a.DirTouchMove=function(t){if(this.active)if(4==this.touchID);else for(var e=this.parent,i=e.parent,a=0;a<i.controldirarr.length;a++){var n=i.controldirarr[a],s=parseInt(n.name);if(-1!=s){if(n.hitTestPoint(t.$stageX,t.stageY)&&this.touchID!=s){this.touchID=s,this.playerrole.stopmove(),this.playerrole.startmove(this.touchID);break}}else!n.hitTestPoint(t.stageX,t.stageY)}},a.DirTouchEnd=function(t){this.active&&(this.active=!1,4==this.touchID?this.playerrole.putbomb():(this.playerrole.stopmove(),this.touchID=-1))},a.DirTouchCancel=function(t){this.active&&(this.active=!1,4==this.touchID||(this.playerrole.stopmove(),this.touchID=-1))},e}(GameUtil.MyBitmap);egret.registerClass(Dircontorllayer,"Dircontorllayer");var SoundName;!function(t){t[t.clicksound=0]="clicksound",t[t.startsound=1]="startsound",t[t.putbombsound=2]="putbombsound",t[t.bombsound=3]="bombsound",t[t.diesound=4]="diesound",t[t.startgamebgm=5]="startgamebgm",t[t.gamebgm=6]="gamebgm"}(SoundName||(SoundName={}));var GameData=function(){function t(){this.GameOver=!1,this.isLoadingend=!1,this.isgetInfoend=!1,this.isSoundOn=[!0,!0],this.gamesound=[],this.UserInfo={ID:"",nickname:"",gender:0,roletype:"",rolename:0,openid:"",paopaocount:0,jifen:0,killcount:0,bekillcount:0,shareopenid:"",prizecount:3}}var e=(__define,t),i=e.prototype;return i.init=function(){console.log("init"),this.PlayerRoleType=0,this.PlayerToolType=0,this.PlayerBubbleNumber=this.UserInfo.paopaocount,this.PlayerHadrole=[0],this.PlayerHadtool=[0],this.PlayerRoleSpeed=20,this.PlayerScore=0,this.PlayerKill=0,this.PlayerDied=0},t._i=function(){return this._inst=null==this._inst?new t:this._inst},t.AIROLENUM=4,t.OBSNUM=25,t._inst=null,t}();egret.registerClass(GameData,"GameData");var GameUtil;!function(t){var e=function(t){function e(){t.call(this),this.mStageW=egret.MainContext.instance.stage.stageWidth,this.mStageH=egret.MainContext.instance.stage.stageHeight,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),a=i.prototype;return a.onAddToStage=function(t){this.init()},a.init=function(){},e}(egret.DisplayObjectContainer);t.BassPanel=e,egret.registerClass(e,"GameUtil.BassPanel");var i=function(){function e(){}var i=(__define,e);i.prototype;return e.init=function(t){this.MainStage=t},e.runscene=function(e,i,a){if(void 0===i&&(i=t.GameConfig.NullAction),void 0===a&&(a=800),null==this.curScene)return this.curScene=e,void this.MainStage.addChild(this.curScene);if(i==t.GameConfig.NullAction)return null!=this.curScene&&this.MainStage.removeChild(this.curScene),this.curScene=e,void this.MainStage.addChild(this.curScene);this.nextScene=e,this.MainStage.addChild(this.nextScene),i==t.GameConfig.TransAlpha&&(this.nextScene.alpha=0,egret.Tween.get(this.curScene).to({alpha:0},a),egret.Tween.get(this.nextScene).to({alpha:1},a)),i==t.GameConfig.CrossLeft&&(this.nextScene.x=-this.MainStage.stageWidth,egret.Tween.get(this.curScene).to({x:this.MainStage.stageWidth},a),egret.Tween.get(this.nextScene).to({x:0},a)),i==t.GameConfig.OpenDoor;var n=this;egret.setTimeout(function(){n.MainStage.removeChild(n.curScene),n.curScene=n.nextScene},this,a)},e.curScene=null,e.nextScene=null,e.MainStage=null,e}();t.GameScene=i,egret.registerClass(i,"GameUtil.GameScene")}(GameUtil||(GameUtil={}));var GameOverScene=function(t){function e(e,i,a,n){t.call(this),this.initdata(e,i,a,n)}__extends(e,t);var i=(__define,e),a=i.prototype;return a.initdata=function(t,e,i,a){this.showgameoverbg(t,e,i,a)},a.showgameoverbg=function(t,e,i,a){this.touchEnabled=!0;var n=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.6);this.addChild(n);var s={openid:GameData._i().UserInfo.openid,type:3,count:GameData._i().PlayerKill};GameUtil.Http.getinstance().send(s,"/paopao/updatekilldata",this.sendanother,this)},a.sendanother=function(t){if(1==t.code){var e={openid:GameData._i().UserInfo.openid,type:4,count:GameData._i().PlayerDied};GameUtil.Http.getinstance().send(e,"/paopao/updatekilldata",this.showscene,this)}else t.msg},a.showscene=function(t){if(1==t.code){var e=new GameUtil.MyBitmap(RES.getRes("gameoverbg_png"),this.mStageW/2,this.mStageH/2);this.addChild(e);var i=new GameUtil.MyBitmap(RES.getRes("gameovertext_png"),this.mStageW/2,512);this.addChild(i),GameUtil.relativepos(i,e,246,61);for(var a=["gameovershare_png","gameoverturnback_png","gameoverrelife_png"],n=[this.share,this.turnback,this.relife],s=0;3>s;s++){var o=new GameUtil.Menu(this,a[s],a[s],n[s]);this.addChild(o),GameUtil.relativepos(o,e,70+165*s,500)}for(var r=["得分:","击杀:","被杀:","反杀:"],h=[150*GameData._i().PlayerKill,GameData._i().PlayerKill,GameData._i().PlayerDied,0],s=0;4>s;s++){var l=new GameUtil.MyTextField(253,588+60*s,50,0,0);l.setText(r[s]),l.textColor=16777215,this.addChild(l),GameUtil.relativepos(l,e,70,130+60*s);var c=new GameUtil.MyTextField(378,588+60*s,50,0,0);c.setText(""+h[s]),c.textColor=16116555,this.addChild(c),GameUtil.relativepos(c,e,195,130+60*s)}}else t.msg},a.share=function(){var t=new egret.DisplayObjectContainer;this.addChild(t);var e=this,i=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.6);t.addChild(i),i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.removeChild(t)},this);var a=new GameUtil.MyBitmap(RES.getRes("sharetip_png"),this.mStageW,0);a.setanchorOff(1,0),t.addChild(a)},a.turnback=function(){GameData._i().PlayerDied=0,GameData._i().PlayerKill=0,GameData._i().PlayerScore=0,this.parent.removeChild(this),GameData._i().gamesound[SoundName.gamebgm].stop(),GameUtil.GameScene.runscene(new StartGameScene)},a.relife=function(){var t=this.parent;t.reset();for(var e=0;e<t.rolearr.length;e++){var i=t.rolearr[e];i.reset()}this.parent.removeChild(this)},e}(GameUtil.BassPanel);egret.registerClass(GameOverScene,"GameOverScene");var DIRECTION;!function(t){t[t.UP=0]="UP",t[t.RIGHT=1]="RIGHT",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT"}(DIRECTION||(DIRECTION={}));var GameScene=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),a=i.prototype;return a.init=function(){this.rolearr=[],this.bombarr=[],this.readybomarr=[],this.bomeffectarr=[],this.controldirarr=[],GameData._i().GameOver=!1,this.showgamebg()},a.showgamebg=function(){GameData._i().gamesound[SoundName.gamebgm].play(0,-1);var t=GameUtil.GameConfig._i().bgamemusic?1:0;GameData._i().gamesound[SoundName.gamebgm].setvolume(t),this.GameMapContain=new egret.DisplayObjectContainer,this.addChild(this.GameMapContain);var e=new GameUtil.MyBitmap(RES.getRes("mapblue_png"),0,0);e.setanchorOff(0,0),e.width*=GameUtil.getscalex(),e.height*=GameUtil.getscaley(),this.GameMapContain.addChild(e),this.GameMapContain.$setWidth(e.width),this.GameMapContain.$setHeight(e.height),this.playerrole=new RoleSprite("roletype"+GameData._i().PlayerRoleType,4,80,this.mStageW/2,this.mStageH/2,!1),this.GameMapContain.addChild(this.playerrole),this.playerrole.setSuperstate(),this.playerrole.initgamecontain(),this.playerrole.setLoop(-1),this.playerrole.play(),this.playerrole.pause(),this.playerrole.speed=GameData._i().PlayerRoleSpeed,this.playerrole.bompower=1,this.rolearr.push(this.playerrole),this.playeridtext=new GameUtil.MyTextField(this.playerrole.x-this.playerrole.width/2,this.playerrole.y-this.playerrole.height/2-30,30),this.playeridtext.textColor=16777215,this.playeridtext.text=""+GameData._i().UserInfo.ID,this.GameMapContain.addChild(this.playeridtext);for(var i=0;i<GameData.AIROLENUM;i++)this.createrole();this.obscontain=new egret.DisplayObjectContainer,this.GameMapContain.addChild(this.obscontain),this.toolcontain=new egret.DisplayObjectContainer,this.GameMapContain.addChild(this.toolcontain);var a=new egret.DisplayObjectContainer;a.width=this.mStageW,a.height=this.mStageH,this.addChild(a);var n=new Dircontorllayer(RES.getRes("roleControlimg_png"),this.mStageW/2,this.mStageH-214,-1,this.playerrole);a.addChild(n),n.initobj(-1,this.playerrole);for(var s=[[179,181],[185,50],[303,170],[185,300],[60,175]],i=0;5>i;i++){var o=4,r=new GameUtil.MyBitmap(RES.getRes("helpselect_png"),s[i][0],s[i][1]);0==i&&(o=14),r.scaleX=o,r.scaleY=o,r.alpha=0,this.addChild(r),r.name=""+(i-1),this.controldirarr.push(r),GameUtil.relativepos(r,n,s[i][0],s[i][1])}var h=new GameUtil.Menu(this,"putbombtn_png","putbombtn_png",this.putbomb);h.x=this.mStageW/2,h.y=this.mStageH-214,this.addChild(h),this.increateobstag=egret.setInterval(this.createobs,this,3e3),this.increatetooltag=egret.setInterval(this.createtool,this,5e3)},a.putbomb=function(){this.playerrole.putbomb()},a.createrole=function(){var t=[100,500,1e3,2e3],e=[100,400,200,300],i=Math.floor(100*Math.random())%5,a=Math.floor(100*Math.random())%4,n=Math.floor(100*Math.random())%4,s=new RoleSprite("roletype"+i,4,80,t[a],e[n]);s.bompower=1,this.GameMapContain.addChild(s),s.initgamecontain(),s.setLoop(-1),s.play(),s.pause(),s.speed=20,this.rolearr.push(s)},a.createobs=function(){if(!(this.obscontain.numChildren>=GameData.OBSNUM)){var t=Math.floor(100*Math.random())%12,e=100+Math.floor(1e5*Math.random())%(this.GameMapContain.width-100),i=100+Math.floor(1e5*Math.random())%(this.GameMapContain.height-100),a=new Obstrution(RES.getRes("obstrution"+t+"_png"),e,i);this.obscontain.addChild(a),this.chekcobspos(a)}},a.createtool=function(){if(!(this.toolcontain.numChildren>=4)){var t=Math.floor(100*Math.random())%2,e=60+Math.floor(1e5*Math.random())%(this.GameMapContain.width-100),i=60+Math.floor(1e5*Math.random())%(this.GameMapContain.height-100),a=new Obstrution(RES.getRes("tool"+t+"_png"),e,i);a.tooltype=t,this.toolcontain.addChild(a),this.chekcobspos(a)}},a.chekcobspos=function(t){for(var e=!0;e;){for(var i=!1,a=0;a<this.obscontain.numChildren-1;a++){var n=this.obscontain.getChildAt(a),s=this.getrect(n),o=this.getrect(t);if(s.intersects(o)){t.x+=200,i=!0;break}}i||(e=!1)}},a.setPlayerIDpos=function(t,e){this.playeridtext.x=t-this.playerrole.width/2,this.playeridtext.y=e},a.gameover=function(){GameData._i().GameOver=!0,egret.clearInterval(this.increateobstag),egret.clearInterval(this.increatetooltag),this.addChild(new GameOverScene(100,1,1,0))},a.reset=function(){GameData._i().GameOver=!1,this.increateobstag=egret.setInterval(this.createobs,this,3e3),this.increatetooltag=egret.setInterval(this.createtool,this,5e3)},a.getrect=function(t){var e=t.getBounds();return e.x=t.x-t.width/2,e.y=t.y-t.height/2,e},e}(GameUtil.BassPanel);egret.registerClass(GameScene,"GameScene");var AdaptGamelayer=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),a=i.prototype;return a.initlayer=function(t){this.maxheight=t},a.putItme=function(t){this.addChild(t)},a.adpat=function(t){void 0===t&&(t=!0);var e=1;this.$getHeight()>this.maxheight&&(e=this.maxheight/this.$getHeight(),t?this.scaleX=this.scaleY=e:this.scaleY=e);var i=(this.mStageW-this.$getWidth()*this.scaleX)/2;this.x=i},e._i=function(){return null==this.inst&&(this.inst=new e),this.inst},e}(GameUtil.BassPanel);egret.registerClass(AdaptGamelayer,"AdaptGamelayer");var GameUtil;!function(t){var e=function(t){function e(e,i,a,n,s){t.call(this,RES.getRes(e+"1_png"),n,s),this.currentNumber=1,this.countNumber=0,this.bLoopCount=0,this.endcallfun=null,this.thisObj=null,this.bpause=!1,this.textureName=e,this.totalNumber=i,this.frameRate=a}__extends(e,t);var i=(__define,e),a=i.prototype;return a.setLoop=function(t){0==t&&(t=1),this.bLoopCount=t-1},a.play=function(){this.intervaltag=egret.setInterval(this.run,this,this.frameRate)},a.run=function(){this.nextFrame()},a.pause=function(){this.bpause=!0},a.resume=function(){this.bpause=!1},a.stop=function(){egret.clearInterval(this.intervaltag)},a.nextFrame=function(){if(!this.bpause){if(this.currentNumber++,this.currentNumber>=this.totalNumber){if(this.currentNumber=1,0==this.bLoopCount)return this.stop(),null!=this.endcallfun&&this.endcallfun.apply(this.thisObj),void this.parent.removeChild(this);this.bLoopCount>0&&this.bLoopCount--}this.setNewTexture(RES.getRes(this.textureName+this.currentNumber+"_png"))}},a.setendcall=function(t,e){this.thisObj=e,this.endcallfun=t},e}(t.MyBitmap);t.Animation=e,egret.registerClass(e,"GameUtil.Animation")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(t){function e(e,i,a){void 0===i&&(i=0),void 0===a&&(a=0),t.call(this),this.imgUrl=e,this.imgwidth=i,this.imgheight=a,this.init()}__extends(e,t);var i=(__define,e),a=i.prototype;return a.init=function(){RES.getResByUrl(this.imgUrl,this.comp,this,RES.ResourceItem.TYPE_IMAGE)},a.comp=function(t){this.imag=new egret.Bitmap,this.imag.texture=t,this.addChild(this.imag),0!=this.imgwidth&&(this.imag.width=this.imgwidth),0!=this.imgheight&&(this.imag.height=this.imgheight),this.imag.anchorOffsetX=this.imgwidth/2,this.imag.anchorOffsetY=this.imgheight/2},a.getimg=function(){return this.imag},e}(egret.DisplayObjectContainer);t.GetImageByUrl=e,egret.registerClass(e,"GameUtil.GetImageByUrl")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(t){function e(e,i,a){void 0===i&&(i=0),void 0===a&&(a=0),t.call(this),this.imgUrl=e,this.imgwidth=i,this.imgheight=a,this.init()}__extends(e,t);var i=(__define,e),a=i.prototype;return a.init=function(){RES.getResAsync(this.imgUrl,this.comp,this)},a.comp=function(t){this.imag=new egret.Bitmap,this.imag.texture=t,this.addChild(this.imag),0!=this.imgwidth&&(this.imag.width=this.imgwidth),0!=this.imgheight&&(this.imag.height=this.imgheight),this.imag.anchorOffsetX=this.imgwidth/2,this.imag.anchorOffsetY=this.imgheight/2},e}(egret.DisplayObjectContainer);t.GetResByany=e,egret.registerClass(e,"GameUtil.GetResByany")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(){function e(t,e){void 0===t&&(t=egret.URLRequestMethod.POST),void 0===e&&(e=egret.URLLoaderDataFormat.TEXT),this.init(t,e)}var i=(__define,e),a=i.prototype;return a.init=function(t,e){void 0===t&&(t=egret.URLRequestMethod.POST),void 0===e&&(e=egret.URLLoaderDataFormat.TEXT),this.urlLoader=new egret.URLLoader,this.urlLoader.dataFormat=e,this.urlLoader.addEventListener(egret.Event.COMPLETE,this.loaded,this),this.urlRequest=new egret.URLRequest,this.urlRequest.method=t},a.loaded=function(t){this.urlLoader.removeEventListener(egret.Event.COMPLETE,this.loaded,this),this.thisObj.removeChild(this.coverBg);var e=JSON.parse(this.urlLoader.data);null!=this.onLoader&&this.onLoader.apply(this.thisObj,[e])},a.send=function(e,i,a,n,s){void 0===a&&(a=null),void 0===n&&(n=null),void 0===s&&(s=t.GameConfig.IP),this.urlRequest.url="Http://"+s+i,this.onLoader=a,this.thisObj=n;var o=new egret.URLVariables(t.objectToString(e));this.urlRequest.data=o,this.urlLoader.addEventListener(egret.Event.COMPLETE,this.loaded,this),this.urlLoader.load(this.urlRequest),this.coverBg=t.createRect(0,0,window.screen.availWidth,window.screen.availHeight,0),this.thisObj.addChild(this.coverBg),this.coverBg.touchEnabled=!0},a.setReqMethod=function(t){this.urlRequest.method=t},e.getinstance=function(t,i){return void 0===t&&(t=egret.URLRequestMethod.POST),void 0===i&&(i=egret.URLLoaderDataFormat.TEXT),null==e._instance&&(e._instance=new e(t,i)),e._instance},e}();t.Http=e,egret.registerClass(e,"GameUtil.Http")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(t){function e(e,i,a,n,s){void 0===n&&(n=.5),void 0===s&&(s=.5),t.call(this),this.init(e,i,a,n,s)}__extends(e,t);var i=(__define,e),a=i.prototype;return a.init=function(t,e,i,a,n){this.textColor=0,this.fontFamily="楷体",this.$setX(t),this.$setY(e),this.$setSize(i),this.anchorX=a,this.anchorY=n},a.setText=function(t){this.text=t,this.setanchorOff(this.anchorX,this.anchorY)},a.setSize=function(t){this.size=t,this.setanchorOff(this.anchorX,this.anchorY)},a.setanchorOff=function(t,e){this.anchorOffsetX=this.$getWidth()*t,this.anchorOffsetY=this.$getHeight()*e},e}(egret.TextField);t.MyTextField=e,egret.registerClass(e,"GameUtil.MyTextField")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(t){function e(e,i,a,n,s,o,r){void 0===o&&(o=.5),void 0===r&&(r=.5),t.call(this,e,i,a,o,r),this.width=n,this.height=a,this.type=egret.TextFieldType.INPUT,this.baseText="",this.addEventListener(egret.FocusEvent.FOCUS_IN,this.onFocusIn,this),this.addEventListener(egret.FocusEvent.FOCUS_OUT,this.onFocusOut,this)}__extends(e,t);var i=(__define,e),a=i.prototype;return a.setBaseText=function(t,e){this.baseText=t,this.baseTextAlpha=e,this.setText(this.baseText),this.alpha=this.baseTextAlpha},a.setBaseTextSize=function(t,e){this.basetextsize=t,this.sourcesize=e,this.text==this.baseText&&(this.setSize(this.basetextsize),this.height=t)},a.onFocusIn=function(t){this.text==this.baseText&&(this.setText(""),this.height=this.sourcesize,this.setSize(this.sourcesize),this.alpha=1)},a.onFocusOut=function(t){""==this.text&&(this.setText(this.baseText),this.alpha=this.baseTextAlpha,this.height=this.basetextsize,this.setSize(this.basetextsize))},e}(t.MyTextField);t.InputTextFiled=e,egret.registerClass(e,"GameUtil.InputTextFiled")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(){function t(t,e){this.loadedfun=t,this.thisObj=e,this.loadingRes()}var e=(__define,t),i=e.prototype;return i.loadingRes=function(){RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},i.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preloading")},i.onResourceLoadComplete=function(t){"preloading"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.loadedfun.apply(this.thisObj))},i.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},i.onResourceProgress=function(t){"preloading"==t.groupName},t}();t.LoadingLogopre=e,egret.registerClass(e,"GameUtil.LoadingLogopre")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(e){function i(t,i,a,n,s,o){void 0===a&&(a=0),void 0===n&&(n=0),void 0===s&&(s=!1),void 0===o&&(o=4),e.call(this),this.loadedfun=t,this.thisObj=i,this.IsGif=s,this.gifTotalcount=o,this.loadingbarOffX=a,this.loadingbarOffY=n}__extends(i,e);var a=(__define,i),n=a.prototype;return n.init=function(){new t.LoadingLogopre(this.onComplete,this),this.loadsound();var e={openId:GameData._i().UserInfo.openid,nickname:t.getQueryString("nickname")};t.Http.getinstance().send(e,"/paopao/adduserinfo",this.setplayerinfo,this)},n.loadsound=function(){for(var t=["clicksound.mp3","startsound.mp3","putbombsound.mp3","bombsound.mp3","diesound.mp3","startgamebgm.mp3","gamebgm.mp3"],e=0;e<t.length;e++)GameData._i().gamesound[e]=new MySound(t[e])},n.onComplete=function(e){if(this.IsGif)this.gifruncount=0,this.loadingbar=new t.MyBitmap(RES.getRes("loadinggif0_png"),this.mStageW/2+this.loadingbarOffX,this.mStageH/2+this.loadingbarOffY),this.addChild(this.loadingbar),egret.setInterval(this.rungif,this,150);else{this.loadingbar=new t.MyBitmap(RES.getRes("loadingbar_png"),this.loadingbarOffX,this.mStageH/2+this.loadingbarOffY),this.loadingbar.x=(this.mStageW-this.loadingbar.texture.textureWidth)/2,this.loadingbar.anchorOffsetX=0;var i=this.loadingbar.texture.textureWidth-8,a=this.loadingbar.texture.textureHeight-8,n=new egret.Rectangle(4,4,i,a);this.loadingbar.scale9Grid=n,this.addChild(this.loadingbar),this.loadingbar.width=10}this.loadingRes()},n.rungif=function(){this.gifruncount++,this.gifruncount>=this.gifTotalcount&&(this.gifruncount=0),this.loadingbar.setNewTexture(RES.getRes("loadinggif"+this.gifruncount+"_png"))},n.loadingRes=function(){this.loadingView=new LoadingUI,this.loadingView.x=this.mStageW/2,this.loadingView.y=this.mStageH/2+this.loadingbarOffY+30,this.addChild(this.loadingView),this.loadingView.anchorOffsetX=this.loadingView.width/2,RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},n.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preload")},n.onResourceLoadComplete=function(t){"preload"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.loadedfun.apply(this.thisObj))},n.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},n.onResourceProgress=function(t){"preload"==t.groupName&&(this.IsGif||this.setPro(t.itemsLoaded/t.itemsTotal),this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal))},n.setPro=function(t){this.loadingbar.width=this.loadingbar.texture.textureWidth*t},n.getPro=function(){return this.loadingbar.width/this.loadingbar.texture.textureWidth},n.setplayerinfo=function(t){if(console.log("inforesult=========",t),0==t.code)console.log(t.msg);else{var e=t.result;console.log(e),GameData._i().UserInfo.ID="SXD_"+e.id,GameData._i().UserInfo.nickname=e.nickname,GameData._i().UserInfo.gender=e.gender,GameData._i().UserInfo.roletype=e.roletype,GameData._i().UserInfo.rolename=e.rolename,GameData._i().UserInfo.openid=e.openid,GameData._i().UserInfo.paopaocount=e.paopaocount,GameData._i().UserInfo.jifen=e.jifen,GameData._i().UserInfo.killcount=e.killcount,GameData._i().UserInfo.bekillcount=e.bekillcount,GameData._i().UserInfo.prizecount=3-e.prizecount,GameData._i().init(),GameData._i().isLoadingend=!0}},i}(t.BassPanel);t.LoadingPanel=e,egret.registerClass(e,"GameUtil.LoadingPanel")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(e){function i(t,i,a,n,s,o){void 0===s&&(s=null),void 0===o&&(o=null),e.call(this),this.menuNormalTexture=null,this.menuSelectTexture=null,this.menubgimg=null,this.bScaleMode=!1,this.mScale=.9,this.isActive=!1,this.thisObj=t,this.param=s,this.menubgimg=o,this.btnImg=null,null!=this.menubgimg?this.initwithshape(n):this.initwithimg(i,a,n)}__extends(i,e);var a=(__define,i),n=a.prototype;return n.initwithimg=function(e,i,a){void 0===a&&(a=null),this.menuNormalTexture=RES.getRes(e),this.menuSelectTexture=RES.getRes(i),this.backFun=a,this.btnImg=new t.MyBitmap(this.menuNormalTexture,0,0),this.addChild(this.btnImg),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.TouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.TouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.TouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.TouchCancel,this)},n.initwithshape=function(t){this.backFun=t,this.addChild(this.menubgimg),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.TouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.TouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.TouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.TouchCancel,this)},n.setBackFun=function(t){this.backFun=t},n.setScaleMode=function(t){void 0===t&&(t=.9),this.bScaleMode=!0,this.mScale=t},n.setButtonTexture=function(t,e){this.menuNormalTexture=RES.getRes(t),this.menuSelectTexture=RES.getRes(e),this.btnImg.setNewTexture(this.menuNormalTexture)},n.addButtonImg=function(e,i,a){void 0===i&&(i=0),void 0===a&&(a=0),this.addImg=new t.MyBitmap(RES.getRes(e),i,a),this.addChild(this.addImg)},n.setAddImgTexture=function(t){this.addImg.setNewTexture(RES.getRes(t))},n.addButtonText=function(e,i,a,n){void 0===a&&(a=0),void 0===n&&(n=0),null!=this.btnImg?this.mTextField=new t.MyTextField(a,n,i):this.mTextField=new t.MyTextField(a,n,i),this.mTextField.setText(e),this.addChild(this.mTextField)},n.getBtnText=function(){return this.mTextField},n.setBtnScale=function(t,e){this.btnImg.scaleX=t,this.btnImg.scaleY=e},n.TouchBegin=function(t){GameData._i().gamesound[SoundName.clicksound].play(0,1),null!=this.btnImg&&this.btnImg.setNewTexture(this.menuSelectTexture),this.bScaleMode&&(this.scaleX=this.scaleY=this.mScale),this.isActive=!0},n.TouchMove=function(t){},n.TouchEnd=function(t){null!=this.btnImg&&this.btnImg.setNewTexture(this.menuNormalTexture),this.bScaleMode&&(this.scaleX=this.scaleY=1),this.isActive&&this.backFun.apply(this.thisObj,this.param),this.isActive=!1},n.TouchCancel=function(t){null!=this.btnImg&&this.btnImg.setNewTexture(this.menuNormalTexture),this.bScaleMode&&(this.scaleX=this.scaleY=1),this.isActive=!1},i}(egret.DisplayObjectContainer);t.Menu=e,egret.registerClass(e,"GameUtil.Menu")}(GameUtil||(GameUtil={}));var MySound=function(){function t(t){this.isadddone=!1,this.init(t)}var e=(__define,t),i=e.prototype;return i.init=function(t){this.sound=new egret.Sound;var e=this;this.sound.addEventListener(egret.Event.COMPLETE,function(t){e.isadddone=!0},this),this.sound.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){console.log("loaded error!")},this),this.sound.load("resource/assets/sound/"+t)},i.play=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=1),GameUtil.GameConfig._i().bgamesound){var i=this.sound;this.isadddone&&(this.soundchannel=i.play(t,e))}},i.stop=function(){this.soundchannel&&this.soundchannel.stop()},i.setvolume=function(t){this.soundchannel&&(this.soundchannel.volume=t)},t}();egret.registerClass(MySound,"MySound");var GameUtil;!function(t){var e=function(e){function i(t,i,a,n,s,o){void 0===s&&(s=0),void 0===o&&(o=.5),e.call(this),this.mPercent=100,this.init(t,i,a,n,s,o)}__extends(i,e);var a=(__define,i),n=a.prototype;return n.init=function(e,i,a,n,s,o){this.progressbar=new t.MyBitmap(RES.getRes(e),i,a),this.addChild(this.progressbar),this.progressbar.scale9Grid=n,this.progressbar.setanchorOff(s,o)},n.setbarX=function(t){this.progressbar.x=t},n.setbarY=function(t){this.progressbar.y=t},n.setPercent=function(t){0>t||(this.mPercent=t,this.updateWidth())},n.getPercent=function(){return this.mPercent},n.updateWidth=function(){this.progressbar.width=this.progressbar.texture.textureWidth*this.mPercent},i}(egret.DisplayObjectContainer);t.ProgressBar=e,egret.registerClass(e,"GameUtil.ProgressBar")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(e){function i(t,i){e.call(this),this.item=[],this.curseltTag=0,this.itemCount=-1,this.normalTexture=t,this.selectTexture=i,this.init()}__extends(i,e);var a=(__define,i),n=a.prototype;return n.init=function(){},n.addItem=function(e,i,a){this.itemCount++;var n=new egret.DisplayObjectContainer,s=new t.Menu(this,this.normalTexture,this.normalTexture,this.chooseButton,[this.itemCount]);s.x=i,s.y=a,n.addChild(s),e.x=i+s.width/2+e.width/2,e.y=a,n.addChild(e),this.item.push(s),this.addChild(n),0==this.itemCount&&s.setButtonTexture(this.selectTexture,this.selectTexture)},n.chooseButton=function(t){if(t!=this.curseltTag){var e=this.item[t];e.setButtonTexture(this.selectTexture,this.selectTexture);var i=this.item[this.curseltTag];i.setButtonTexture(this.normalTexture,this.normalTexture),this.curseltTag=t}},n.getCurSelectTag=function(){return this.curseltTag},i}(egret.DisplayObjectContainer);t.RadioButton=e,egret.registerClass(e,"GameUtil.RadioButton")}(GameUtil||(GameUtil={}));var RandomUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.limit=function(t,e){t=Math.min(t,e),e=Math.max(t,e);var i=e-t;return t+Math.random()*i},t.limitInteger=function(t,e){return Math.floor(this.limit(t,e+1))
},t.randomArray=function(t){var e=Math.floor(Math.random()*t.length);return t[e]},t}();egret.registerClass(RandomUtils,"RandomUtils");var GameUtil;!function(t){var e=function(t){function e(e,i,a){void 0===a&&(a=.5),t.call(this),this.scrollview=new egret.ScrollView,this.content=new egret.DisplayObjectContainer,this.addChild(this.scrollview),this.scrollview.width=e,this.scrollview.height=i,this.scrollview.scrollSpeed=a,this.init()}__extends(e,t);var i=(__define,e),a=i.prototype;return a.init=function(){this.scrollview.setContent(this.content)},a.putItem=function(t){this.content.addChild(t)},a.clearItem=function(){this.content.removeChildren()},a.getScorllTop=function(){return this.scrollview.scrollTop},a.setScorllTop=function(t){this.scrollview.scrollTop=t},e}(egret.DisplayObjectContainer);t.ScrollView=e,egret.registerClass(e,"GameUtil.ScrollView")}(GameUtil||(GameUtil={}));var SharePage=function(t){function e(){t.call(this),this.desctext="盛讯小游戏--泡泡大作战",this.newurl="http://bubblefightv02.h5.gamexun.com/"}__extends(e,t);var i=(__define,e),a=i.prototype;return a.getSignPackage=function(){var t=encodeURIComponent(window.location.href.split("#")[0]),e={url:t};GameUtil.Http.getinstance().send(e,"/weixinshare/share",this.share,this,"api.h5.gamexun.com")},a.share=function(t){console.log("data======",t),wx.config({debug:!1,appId:t.appId,timestamp:Number(t.timestamp),nonceStr:t.noncestr,signature:t.sign,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo"]}),this.getWeiXinShareTimeline(),this.getWeiXinShareAppMessage()},a.setdesctext=function(t){this.desctext=t,this.getWeiXinShareAppMessage(),this.getWeiXinShareTimeline()},a.setNewUrl=function(t){this.newurl=t,this.getWeiXinShareAppMessage(),this.getWeiXinShareTimeline()},a.getWeiXinShareTimeline=function(){var t=new BodyMenuShareTimeline;t.title=this.desctext,t.link=this.newurl,t.imgUrl="http://bubblefightv02.h5.gamexun.com/shareicon.png",t.trigger=function(){},t.success=function(){},t.cancel=function(){},t.fail=function(t){},wx.onMenuShareTimeline(t)},a.getWeiXinShareAppMessage=function(){var t=new BodyMenuShareAppMessage;t.title="盛讯小游戏--泡泡大作战",t.desc=this.desctext,t.link=this.newurl,t.imgUrl="http://bubblefightv02.h5.gamexun.com/shareicon.png",t.trigger=function(){},t.success=function(){},t.cancel=function(){},t.fail=function(t){},wx.onMenuShareAppMessage(t)},e._i=function(){return null==this.inst&&(this.inst=new e),this.inst},e}(egret.DisplayObjectContainer);egret.registerClass(SharePage,"SharePage");var GameUtil;!function(t){var e=function(e){function i(t,i,a,n){void 0===a&&(a=!1),void 0===n&&(n=1200),e.call(this),this.textsize=30,this.mStageW=egret.MainContext.instance.stage.stageWidth,this.mStageH=egret.MainContext.instance.stage.stageHeight,this.tipText=i,this.tipImg=t,this.bDisappear=a,this.disSecond=n,this.init()}__extends(i,e);var a=(__define,i),n=a.prototype;return n.init=function(){if(this.showtip(),!this.bDisappear){var e=t.createRect(0,0,window.screen.availWidth,window.screen.availHeight,.4);this.addChild(e),this.touchEnabled=!0}if(null==this.tipImg){var i=t.createRect(this.mStageW/2,this.mStageH/2,2*this.text.width,1.5*this.text.height,1,9210760);i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,this.addChild(i)}else this.tipbg=new t.MyBitmap(RES.getRes(this.tipImg),this.mStageW/2,this.mStageH/2),this.addChild(this.tipbg);if(this.bDisappear){var a=egret.Tween.get(this);a.to({alpha:1},300).to({alpha:0},this.disSecond).call(this.close,this)}else this.showbutton();this.addChild(this.text)},n.showtip=function(){this.text=new t.MyTextField(this.mStageW/2,this.mStageH/2,this.textsize),this.text.setText(this.tipText),this.text.textColor=0},n.setTextwidth=function(t){this.text.width=t},n.setTextSize=function(t){this.text.setSize(t)},n.setTextHor=function(t,e,i,a){this.text.textAlign=i,this.text.x=this.mStageW/2-this.tipbg.width/2+a},n.setTextlineSpacing=function(t){this.text.lineSpacing=t},n.showbutton=function(){var e=new t.Menu(this,"acceptBtn_png","acceptBtn_png",this.close);e.x=this.mStageW/2,e.y=this.mStageH/2+this.tipbg.texture.textureHeight/2,this.addChild(e),e.setScaleMode()},n.close=function(){this.parent.removeChild(this)},i}(egret.DisplayObjectContainer);t.TipsPanel=e,egret.registerClass(e,"GameUtil.TipsPanel")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){var e=function(e){function i(t){void 0===t&&(t=0),e.call(this),this.init(t)}__extends(i,e);var a=(__define,i),n=a.prototype;return n.init=function(e){this.coverBg=t.createRect(0,0,640,1136,0),this.addChild(this.coverBg),this.touchEnabled=!0},n.setAlpha=function(t){this.coverBg.alpha=t},i.getInstace=function(){return null==this._instance&&(this._instance=new t.WaitServerPanel(0)),this._instance},i}(egret.DisplayObjectContainer);t.WaitServerPanel=e,egret.registerClass(e,"GameUtil.WaitServerPanel")}(GameUtil||(GameUtil={}));var GameUtil;!function(t){function e(t,e,i,a,n,s){void 0===n&&(n=1),void 0===s&&(s=0);var o=new egret.Shape;return o.x=t,o.y=e,o.graphics.beginFill(s,n),o.graphics.drawRect(0,0,i,a),o.graphics.endFill(),o}function i(t,e,i,a,n){void 0===a&&(a=1),void 0===n&&(n=0);var s=new egret.Shape;return s.x=t,s.y=e,s.graphics.beginFill(n,a),s.graphics.drawCircle(0,0,i),s.graphics.endFill(),s}function a(t){var e="";for(var i in t){var a=i+"="+t[i];e+=a+"&"}return e=e.substr(0,e.length-1)}function n(t){return/^[\u4e00-\u9fa5]+$/.test(t)}function s(t){return t=t.replace(/^/,"")}function o(t){return t=t.toUpperCase(),/^0\d{2,3}-?\d{7,11}$|^1\d{10}$/.test(t)}function r(t,e,i,a,n,s){var o=new egret.TextField;o.x=e,o.y=i,o.size=a,o.textAlign="center",o.textColor=s,o.text=n,t.addChild(o),o.anchorOffsetX=.5*o.width,o.anchorOffsetY=.5*o.height,egret.Tween.get(o).to({y:i-40},700),egret.Tween.get(o).to({alpha:0},700).call(function(){t.removeChild(o)},t)}function h(t,e){egret.localStorage.setItem(t,e)}function l(t){egret.localStorage.getItem(t)}function c(t){null!=t?egret.localStorage.removeItem(t):egret.localStorage.clear()}function u(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return null!=i?decodeURI(i[2]):null}function d(e){return e>=t.GameConfig.DesignHeight/2?y._i().getSH()-(t.GameConfig.DesignHeight-e):e}function g(){var t=Math.floor(100*Math.random());return t}function m(e,i,a,n,s,o){void 0===o&&(o=t.GameConfig.IP);var r=window.getIP;console.log("ipstr======",r);for(var h,l=0;l<r.split("|").length;l++)if(r.split("|")[l].length>6){h=r.split("|")[l];break}console.log("ipstrspl====",h),console.log("money======",e);var c={openId:i,amount:e,ip:h,nickname:a,gameid:0};t.Http.getinstance().send(c,"/weixinpay/pay",n,s,o)}function p(){var t=window.navigator.userAgent.toLowerCase();return-1!=t.indexOf("micromessenger")?!0:!1}function f(){var t=window.navigator.userAgent.toLowerCase();return-1!=t.indexOf("android")?!0:!1}function v(t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i=new egret.ColorMatrixFilter(e);t.filters=[i]}function b(){var t=3394815,e=.8,i=35,a=35,n=2,s=3,o=!1,r=!1,h=new egret.GlowFilter(t,e,i,a,n,s,o,r);return[h]}function C(){var t=1;return y._i().getWH()>y.DesignWidth&&(t=y._i().getWH()/y.DesignWidth),t}function G(){var t=1;return y._i().getSH()>y.DesignHeight&&(t=y._i().getSH()/y.DesignHeight),t}function _(t,e,i,a,n){void 0===n&&(n=!1),n||(t.x=e.x-e.width/2+i,t.y=e.y-e.height/2+a)}var y=function(){function e(){this.stagetY=0,this.stagetX=0,this.bgamemusic=!0,this.bgamesound=!0}var i=(__define,e),a=i.prototype;return e._i=function(){return null==this._instance&&(this._instance=new t.GameConfig),this._instance},a.setStageHeight=function(t){this.stagetY=t},a.getSH=function(){return this.stagetY},a.setStageWidth=function(t){this.stagetX=t},a.getWH=function(){return this.stagetX},e.IP="api.h5.gamexun.com",e.bRunFPS=!1,e.NullAction=0,e.CrossLeft=1,e.TransAlpha=2,e.OpenDoor=3,e.DesignWidth=750,e.DesignHeight=1334,e._instance=null,e}();t.GameConfig=y,egret.registerClass(y,"GameUtil.GameConfig"),t.createRect=e,t.createCircle=i,t.objectToString=a,t.isChineseName=n,t.removeimag=s,t.isPhoneNum=o,t.numberUpDisp=r,t.saveLocalData=h,t.readLocalData=l,t.clearLocalData=c,t.getQueryString=u,t.setscreenY=d,t.getRandom=g,t.getredPack=m,t.isWeiXin=p,t.isAndroid=f,t.changeGray=v,t.changeLight=b,t.getscalex=C,t.getscaley=G,t.relativepos=_}(GameUtil||(GameUtil={}));var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),a=i.prototype;return a.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},a.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),a=i.prototype;return a.onAddToStage=function(t){GameData._i().UserInfo.openid=GameUtil.getQueryString("openid"),GameData._i().UserInfo.shareopenid=GameUtil.getQueryString("shareopenid"),console.log("openid======",GameData._i().UserInfo.openid),GameUtil.getQueryString("openid")?(GameUtil.getQueryString("shareopenid")?GameData._i().UserInfo.shareopenid=GameUtil.getQueryString("shareopenid"):GameData._i().UserInfo.shareopenid=null,this.stage.scaleMode=egret.StageScaleMode.FIXED_NARROW,GameUtil.GameScene.init(this.stage),GameUtil.GameScene.runscene(new GameUtil.LoadingPanel(this.createGameScene,this,0,0))):GameUtil.getQueryString("shareopenid")?window.location.href="http://api.h5.gamexun.com/weixin/auth?game_redirecturl=http://bubblefightv02.h5.gamexun.com/&shareopenid="+GameUtil.getQueryString("shareopenid"):window.location.href="http://api.h5.gamexun.com/weixin/auth?game_redirecturl=http://bubblefightv02.h5.gamexun.com/"},a.createGameScene=function(){GameData._i().isLoadingend?(egret.clearInterval(this.intag),GameUtil.GameConfig._i().setStageHeight(this.stage.stageHeight),GameUtil.GameConfig._i().setStageWidth(this.stage.stageWidth),GameUtil.GameScene.runscene(new StartGameScene)):this.intag=egret.setInterval(this.createGameScene,this,400)},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var Obstrution=function(t){function e(e,i,a,n){void 0===n&&(n=!0),t.call(this,e,i,a),this.isTool=n}__extends(e,t);var i=(__define,e);i.prototype;return e}(GameUtil.MyBitmap);egret.registerClass(Obstrution,"Obstrution");var RoleSprite=function(t){function e(e,i,a,n,s,o){void 0===o&&(o=!0),t.call(this,e,i,a,n,s),this.isSuperstate=!1,this.isAI=o,this.isAI&&(this.aiIntag=egret.setInterval(this.aiRun,this,1e3))}__extends(e,t);var i=(__define,e),a=i.prototype;return a.initgamecontain=function(){this.gamecontain=this.parent.parent,this.parcontain=this.parent},a.setSuperstate=function(){this.isSuperstate=!0;var t=this;egret.Tween.get(this,{loop:!1}).to({alpha:0},500).to({alpha:1},500).to({alpha:0},500).to({alpha:1},500).to({alpha:0},500).to({alpha:1},500).call(function(){t.isSuperstate=!1},t)},a.aiRun=function(){if(this.stopmove(),!GameData._i().GameOver&&null!=this.parent){var t=this,e=Math.floor(100*Math.random());if(e>80){var t=this;this.putbomb(),this.stopmove(),egret.clearInterval(this.aiIntag),egret.setTimeout(function(){t.aiIntag=egret.setInterval(t.aiRun,t,1e3)},t,3e3),e%=4,this.startmove(e)}else e%=4,this.startmove(e)}},a.startmove=function(t){this.rolemovedir=t,this.intage=egret.setInterval(this.moving,this,100),this.resume()},a.moving=function(){var t=this.parcontain;if(null!=t){for(var e=this.gamecontain.obscontain,i=this.gamecontain.toolcontain,a=0;a<i.numChildren;a++){var n=i.getChildAt(a),s=this.getrect(n,1,1),o=this.getrect(this,1,1);if(s.intersects(o)){var r=this,h=this.$getFilters();this.filters=GameUtil.changeLight(),egret.setTimeout(function(t){r.filters=h},this,300),1==n.tooltype?this.speed+=5:this.bompower+=.2,i.removeChild(n)}}for(var l=[!1,!1,!1,!1],a=0;a<e.numChildren;a++){var c=e.getChildAt(a),s=this.getrect(c,.9,.9),o=this.getrect(this,1,1);s.intersects(o)&&(c.y>this.y&&(l[DIRECTION.DOWN]=!0),c.y<this.y&&(l[DIRECTION.UP]=!0),c.x<this.x?l[DIRECTION.LEFT]=!0:c.x>this.x&&(l[DIRECTION.RIGHT]=!0))}var u=this.speed;switch(this.rolemovedir){case DIRECTION.UP:if(l[DIRECTION.UP])return;this.isAI?this.y=this.y-u<=15?15:this.y-u:(0==t.y?this.y=this.y-u<=15?15:this.y-u:(t.y=t.y+u>=0?0:t.y+u,this.y-=u),this.gamecontain.setPlayerIDpos(this.x,this.y-this.height/2-30));break;case DIRECTION.RIGHT:if(l[DIRECTION.RIGHT])return;this.$setScaleX(1),this.isAI?this.x=this.x+u>=t.width-this.width-20?t.width-this.width-20:this.x+u:(t.x==GameUtil.GameConfig._i().getWH()-t.width?this.x=this.x+u>=t.width-this.width-20?t.width-this.width-20:this.x+u:(t.x=t.x-u<=GameUtil.GameConfig._i().getWH()-t.width?GameUtil.GameConfig._i().getWH()-t.width:t.x-u,this.x+=u),this.gamecontain.setPlayerIDpos(this.x,this.y-this.height/2-30));break;case DIRECTION.DOWN:if(l[DIRECTION.DOWN])return;this.isAI?this.y=this.y+u>=t.height-this.height?t.height-this.height:this.y+u:(t.y==GameUtil.GameConfig._i().getSH()-t.height?this.y=this.y+u>=t.height-this.height?t.height-this.height:this.y+u:(t.y=t.y-u<=GameUtil.GameConfig._i().getSH()-t.height?GameUtil.GameConfig._i().getSH()-t.height:t.y-u,this.y+=u),this.gamecontain.setPlayerIDpos(this.x,this.y-this.height/2-30));break;case DIRECTION.LEFT:if(this.$setScaleX(-1),l[DIRECTION.LEFT])return;this.isAI?this.x=this.x-u<=+this.width+20?this.width+20:this.x-u:(0==t.x?this.x=this.x-u<=this.width+20?this.width+20:this.x-u:(t.x=t.x+u>=0?0:t.x+u,this.x-=u),this.gamecontain.setPlayerIDpos(this.x,this.y-this.height/2-30))}}},a.stopmove=function(){this.pause(),egret.clearInterval(this.intage)},a.putbomb=function(){GameData._i().gamesound[SoundName.putbombsound].play(0,1);for(var t=this.parcontain,e=this.gamecontain,i=0;i<e.bombarr.length;i++){var a=e.bombarr[i],n=this.getrect(a,1,1);if(n.contains(this.x,this.y))return}var s=new BombSprite(RES.getRes("shopselftool_"+GameData._i().PlayerToolType+"_png"),this.x,this.y,!this.isAI);s.bompower=this.bompower,e.bombarr.push(s),t.addChild(s),s.initdata(),t.swapChildren(this,s)},a.die=function(t){if(this.isAI){t&&(GameData._i().PlayerKill++,GameData._i().UserInfo.killcount++,GameData._i().UserInfo.jifen+=150);var e=this.gamecontain;egret.clearInterval(this.aiIntag),this.stopmove(),this.parcontain.removeChild(this);var i=e.rolearr.indexOf(this);e.rolearr.splice(i,1),e.createrole()}else{GameData._i().gamesound[SoundName.diesound].play(0,1),GameData._i().PlayerDied++,GameData._i().UserInfo.bekillcount++;for(var e=this.gamecontain,a=0;a<e.rolearr.length;a++){var n=e.rolearr[a];egret.clearInterval(n.aiIntag),n.stopmove()}e.gameover()}},a.getrect=function(t,e,i){var a=t.getBounds();return a.x=t.x-t.width*e/2,a.y=t.y-t.height*i/2,a.width=t.width*e,a.height=t.height*i,a},a.reset=function(){this.speed=GameData._i().PlayerRoleSpeed,this.bompower=1,this.isAI?this.aiIntag=egret.setInterval(this.aiRun,this,1e3):this.setSuperstate()},e}(GameUtil.Animation);egret.registerClass(RoleSprite,"RoleSprite");var StartGameScene=function(t){function e(){t.call(this),this.soundswitch=[],this.burolecount=[50,80,100,120,140,160],this.butoolcount=[50,80,100,120,130,150],this.activerunluck=!0,this.getbubblecount=0}__extends(e,t);var i=(__define,e),a=i.prototype;return a.init=function(){this.soundswitch[1]=GameUtil.GameConfig._i().bgamesound,this.soundswitch[0]=GameUtil.GameConfig._i().bgamemusic,this.showbg()},a.showbg=function(){GameData._i().gamesound[SoundName.startgamebgm].play(0,-1);var t=GameUtil.GameConfig._i().bgamemusic?1:0;GameData._i().gamesound[SoundName.startgamebgm].setvolume(t),GameData._i().UserInfo.nickname=GameUtil.getQueryString("nickname"),this.othercontain=null,this.playcontain=null;var e=new GameUtil.MyBitmap(RES.getRes("startgamebg_png"),0,0);e.setanchorOff(0,0),e.width=this.mStageW,e.height=this.mStageH,this.addChild(e);for(var i=GameUtil.getscalex(),a=["startgamebtn_png","rankbtn_png","helpbtn_png","luckactbtn_png","personbtn_png","settingbtn_png","sharebtn_png","shopbtn_png"],n=[this.startgame,this.gamerank,this.gamehelp,this.luckact,this.personinfo,this.setting,this.share,this.shop],s=[this.mStageW/2,this.mStageW/2,380*i,65,55,260*i,685*i,500*i],o=[950,1100,1260,750,50,1260,50,1260],r=0;8>r;r++){var h=new GameUtil.Menu(this,a[r],a[r],n[r]);h.setScaleMode(),h.x=s[r],h.y=o[r],this.addChild(h)}GameUtil.getQueryString("shareopenid")?(console.log("shareopen enter"),this.getsharebubble()):(SharePage._i().getSignPackage(),SharePage._i().setNewUrl("http://bubblefightv02.h5.gamexun.com/?shareopenid="+GameData._i().UserInfo.openid)),0!=GameData._i().UserInfo.prizecount&&this.luckact()},a.getsharebubble=function(){var t={shareopenid:GameUtil.getQueryString("shareopenid"),clickopenid:GameData._i().UserInfo.openid};GameUtil.Http.getinstance().send(t,"/paopao/updatesharedata",this.setshareresult,this)},a.setshareresult=function(t){1==t.code?(SharePage._i().getSignPackage(),SharePage._i().setNewUrl("http://bubblefightv02.h5.gamexun.com/?shareopenid="+GameData._i().UserInfo.openid)):console.log(t.msg)},a.startgame=function(){GameData._i().gamesound[SoundName.startgamebgm].stop(),console.log("start"),GameData._i().gamesound[SoundName.startsound].play(0,1),GameUtil.GameScene.runscene(new GameScene)},a.gamerank=function(){console.log("rank");var t={};GameUtil.Http.getinstance().send(t,"/paopao/getrank",this.getRank,this)},a.getRank=function(t){if(1==t.code){var e=t.result;this.createContain();var i=new GameUtil.MyBitmap(RES.getRes("rankbg_png"),this.mStageW/2,this.mStageH/2);this.othercontain.addChild(i);var a=new GameUtil.MyBitmap(RES.getRes("ranktext_png"),this.mStageW/2,515);this.othercontain.addChild(a),GameUtil.relativepos(a,i,316,65);for(var n=0;n<e.length;n++){var s=GameUtil.createRect(141,576+51*n,469,38,0),o=new GameUtil.Menu(this,null,null,this.showotherinfo,[e[n].openid],s);this.othercontain.addChild(o),GameUtil.relativepos(s,i,77,128+51*n);var r=GameUtil.createCircle(160,600+52*n,12,1,11707196);this.othercontain.addChild(r),GameUtil.relativepos(r,i,96,147+52*n);var h=GameUtil.createCircle(160,600+52*n,11,1,16377970);this.othercontain.addChild(h),GameUtil.relativepos(h,i,96,147+52*n);var l=new GameUtil.MyTextField(155,600+52*n,20,0);l.$setStroke(2),l.$setStrokeColor(16645455),l.setText(""+(n+1)),l.textColor=16762462,this.othercontain.addChild(l),GameUtil.relativepos(l,i,91,147+52*n);var c=new GameUtil.MyTextField(180,600+52*n,25,0);c.setText(e[n].nickname),c.textColor=16777215,this.othercontain.addChild(c),GameUtil.relativepos(c,i,116,147+52*n);var u=new GameUtil.MyTextField(333,600+52*n,25,0);u.setText("积分:  "+e[n].jifen),u.textColor=16777215,this.othercontain.addChild(u),GameUtil.relativepos(u,i,269,147+52*n);var d=new GameUtil.MyTextField(470,600+52*n,25,0);d.setText("杀敌:  "+e[n].killcount),d.textColor=16777215,this.othercontain.addChild(d),GameUtil.relativepos(d,i,406,147+52*n)}var g=new GameUtil.Menu(this,"closebtn_png","closebtn_png",this.closecontain);this.othercontain.addChild(g),GameUtil.relativepos(g,i,622,16)}else console.log(t.msg)},a.gameaction=function(){console.log("gameaction")},a.gamehelp=function(){console.log("gamehelp"),this.createContain(),this.helpcurtag=0;var t=this;this.helpbgbtn=new GameUtil.MyBitmap(RES.getRes("helpbg_0_png"),this.mStageW/2,694),this.helpbgbtn.touchEnabled=!0;var e=0;this.helpbgbtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){e=t.stageX},this),this.helpbgbtn.addEventListener(egret.TouchEvent.TOUCH_END,function(i){var a=i.stageX;a-e>=100?t.helpcurtag=++t.helpcurtag>3?0:t.helpcurtag:e-a>100&&(t.helpcurtag=--t.helpcurtag<0?3:t.helpcurtag),t.helpbgbtn.setNewTexture(RES.getRes("helpbg_"+t.helpcurtag+"_png")),GameUtil.relativepos(t.helpselect,t.helpbgbtn,300+55*t.helpcurtag,290)},this),this.othercontain.addChild(this.helpbgbtn);for(var i=0;4>i;i++){var a=new GameUtil.MyBitmap(RES.getRes("helppagepoint_png"),367+55*i,800);this.othercontain.addChild(a),GameUtil.relativepos(a,this.helpbgbtn,300+55*i,290)}this.helpselect=new GameUtil.MyBitmap(RES.getRes("helpselect_png"),367,800),this.othercontain.addChild(this.helpselect),GameUtil.relativepos(this.helpselect,this.helpbgbtn,300,290);var n=new GameUtil.Menu(this,"helpclose_png","helpclose_png",this.closecontain);this.othercontain.addChild(n),GameUtil.relativepos(n,this.helpbgbtn,557,48)},a.luckact=function(){console.log("luckact"),this.createContain(),this.freecountT=new GameUtil.MyTextField(this.mStageW/2,320,40,.5,.5),this.freecountT.setText("免费抽奖次数:"+GameData._i().UserInfo.prizecount+"/3"),this.freecountT.textColor=16141124,this.othercontain.addChild(this.freecountT);var t=new GameUtil.MyBitmap(RES.getRes("luckpan_png"),this.mStageW/2,667);this.othercontain.addChild(t),this.luckpoint=new GameUtil.Menu(this,"luckpoint_png","luckpoint_png",this.runluckpoint),this.luckpoint.$setAnchorOffsetY(25),this.luckpoint.setBtnScale(1.1,1.1),this.luckpoint.x=this.mStageW/2+6,this.luckpoint.y=665,this.othercontain.addChild(this.luckpoint),0==GameData._i().UserInfo.prizecount&&(GameUtil.changeGray(this.luckpoint),this.luckpoint.$setTouchEnabled(!1));var e=new GameUtil.Menu(this,"closebtn_png","closebtn_png",this.closecontain);e.x=570*GameUtil.getscalex(),e.y=250,this.othercontain.addChild(e)},a.personinfo=function(){console.log("personinfo"),this.createContain();var t=new GameUtil.MyBitmap(RES.getRes("personinfobg_png"),this.mStageW/2,this.mStageH/2);t.name="infobg",this.othercontain.addChild(t);var e=new GameUtil.Menu(this,"personinfobtn_png","personinfobtn_png",this.playinfo);e.setScaleMode(),this.othercontain.addChild(e),GameUtil.relativepos(e,t,125,46);var i=new GameUtil.Menu(this,"bagbtn_png","bagbtn_png",this.playbag);i.setScaleMode(),this.othercontain.addChild(i),GameUtil.relativepos(i,t,316,46),this.playcontain=new egret.DisplayObjectContainer,this.othercontain.addChild(this.playcontain),this.playinfo();var a=new GameUtil.Menu(this,"closebtn_png","closebtn_png",this.closecontain);this.othercontain.addChild(a),GameUtil.relativepos(a,t,596,7)},a.setting=function(){console.log("setting"),this.switchbtn=[],this.createContain();var t=new GameUtil.MyBitmap(RES.getRes("settingbg_png"),this.mStageW/2,618);this.othercontain.addChild(t);for(var e=0;2>e;e++){var i=new GameUtil.MyBitmap(RES.getRes("settingswitch_png"),524,567+108*e);this.othercontain.addChild(i);var a=this.soundswitch[e]?414:342;GameUtil.relativepos(i,t,a,116+108*e);var n=this.soundswitch[e]?"settingswitchon_png":"settingswitchoff_png";this.switchbtn[e]=new GameUtil.Menu(this,n,n,this.settingswitch,[e,i]),this.othercontain.addChild(this.switchbtn[e]),this.othercontain.swapChildren(i,this.switchbtn[e]),GameUtil.relativepos(this.switchbtn[e],t,376,115+108*e)}var s=new GameUtil.Menu(this,"closebtn_png","closebtn_png",this.closecontain);this.othercontain.addChild(s),GameUtil.relativepos(s,t,530,13)},a.share=function(){console.log("share"),this.createContain();var t=new GameUtil.MyBitmap(RES.getRes("sharebg_png"),this.mStageW/2,this.mStageH/2);t.name="sharebg",this.othercontain.addChild(t);var e="http://bubblefight.h5.gamexun.com/?shareopenid="+GameData._i().UserInfo.openid,i=qr.QRCode.create(e,0,180,180);this.othercontain.addChild(i),GameUtil.relativepos(i,t,75,135);var a=new GameUtil.Menu(this,"sharecordbtn_png","sharecordbtn_png",this.sharegame);a.setScaleMode(),this.othercontain.addChild(a),GameUtil.relativepos(a,t,163,360);var n=new GameUtil.Menu(this,"closebtn_png","closebtn_png",this.closecontain);this.othercontain.addChild(n),GameUtil.relativepos(n,t,616,13)},a.shop=function(){console.log("shop");var t={openid:GameData._i().UserInfo.openid};GameUtil.Http.getinstance().send(t,"/paopao/getmypack",this.getshop,this)},a.getshop=function(t){if(1==t.code){for(var e=t.result,i=0;i<e.length;i++)1==e[i].propstype?(console.log(GameData._i().PlayerHadrole.indexOf(parseInt(e[i].propsname))),GameData._i().PlayerHadrole.indexOf(parseInt(e[i].propsname))<0&&GameData._i().PlayerHadrole.push(parseInt(e[i].propsname))):GameData._i().PlayerHadtool.indexOf(parseInt(e[i].propsname))<0&&GameData._i().PlayerHadtool.push(parseInt(e[i].propsname));this.createContain();var a=new GameUtil.MyBitmap(RES.getRes("shopbg_png"),this.mStageW/2,708);a.name="shopbg",this.othercontain.addChild(a),this.shopbagcontain=new egret.DisplayObjectContainer,this.othercontain.addChild(this.shopbagcontain);var n=new GameUtil.Menu(this,"rolebtn_png","rolebtn_png",this.showshopbagrole);n.setScaleMode(),this.othercontain.addChild(n),GameUtil.relativepos(n,a,146,67);var s=new GameUtil.Menu(this,"toolbtn_png","toolbtn_png",this.showshopbagtool);s.setScaleMode(),this.othercontain.addChild(s),GameUtil.relativepos(s,a,490,67),this.showshopbagrole();var o=new GameUtil.Menu(this,"closebtn_png","closebtn_png",this.closecontain);this.othercontain.addChild(o),GameUtil.relativepos(o,a,630,18)}else console.log(t.msg)},a.createContain=function(){this.othercontain=new egret.DisplayObjectContainer,this.addChild(this.othercontain),this.othercontain.touchEnabled=!0;var t=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.6);this.othercontain.addChild(t)},a.closecontain=function(){egret.Tween.removeAllTweens(),this.removeChild(this.othercontain),this.othercontain=null},a.runluckpoint=function(){if(this.activerunluck){this.activerunluck=!1;var t=this;this.othercontain.getChildByName("lucktiptext")&&this.othercontain.removeChild(this.othercontain.getChildByName("lucktiptext"));var e=RandomUtils.randomArray([2,5,8]),i=this.getrotatag(e)+720,a=i;egret.Tween.get(this.luckpoint).to({rotation:i},a,egret.Ease.sineInOut).call(t.sendluckresult,this,[e])}},a.sendluckresult=function(t){console.log("rota=====",t);var e=t,i=[100,30,1,10,100,5,50,20,2,50],a=["100泡泡","30元话费","1泡泡","10泡泡","100元话费","5泡泡","50泡泡","20泡泡","2泡泡","50元话费"];this.getbubblecount=i[e];var n={openid:GameData._i().UserInfo.openid,prizename:a[e],paopaocount:i[e]};GameUtil.Http.getinstance().send(n,"/paopao/addprize",this.addprizeresult,this)},a.addprizeresult=function(t){if(this.activerunluck=!0,1==t.code){GameData._i().PlayerBubbleNumber+=this.getbubblecount;var e=new GameUtil.MyTextField(this.mStageW/2,1080,50);e.name="lucktiptext",e.setText("恭喜您，获得了"+this.getbubblecount+"个泡泡"),e.textColor=16141124,this.othercontain.addChild(e),GameData._i().UserInfo.prizecount-=1,this.freecountT.setText("免费抽奖次数:"+GameData._i().UserInfo.prizecount+"/3"),0==GameData._i().UserInfo.prizecount&&(GameUtil.changeGray(this.luckpoint),this.luckpoint.$setTouchEnabled(!1))}else{console.log(t.msg);var e=new GameUtil.MyTextField(this.mStageW/2,1080,50);e.name="lucktiptext",e.setText(t.msg),e.textColor=16141124,this.othercontain.addChild(e)}},a.playinfo=function(){var t=this.othercontain.getChildByName("infobg");this.playcontain.removeChildren();var e=new GameUtil.MyBitmap(RES.getRes("roletype_"+GameData._i().PlayerRoleType+"_png"),185,683);this.playcontain.addChild(e),GameUtil.relativepos(e,t,123,205);for(var i=["ID:","名字:","泡泡:","总积分:","总击杀:","被杀:"],a=[""+GameData._i().UserInfo.ID,GameData._i().UserInfo.nickname,""+GameData._i().PlayerBubbleNumber,""+GameData._i().UserInfo.jifen,""+GameData._i().UserInfo.killcount,""+GameData._i().UserInfo.bekillcount],n=0;6>n;n++){var s=new GameUtil.MyTextField(340,600+35*n,30,0);s.setText(i[n]),s.textColor=8880072,this.playcontain.addChild(s),GameUtil.relativepos(s,t,260,122+35*n);var o=new GameUtil.MyTextField(450,600+35*n,30,0);o.setText(a[n]),o.textColor=8880072,this.playcontain.addChild(o),GameUtil.relativepos(o,t,370,122+35*n)}},a.playbag=function(){var t={openid:GameData._i().UserInfo.openid};GameUtil.Http.getinstance().send(t,"/paopao/getmypack",this.getplayerbag,this)},a.getplayerbag=function(t){if(1==t.code){var e=t.result;this.playcontain.removeChildren(),this.bagcontain=new egret.DisplayObjectContainer,this.playcontain.addChild(this.bagcontain);for(var i=0;i<e.length;i++)1==e[i].propstype?GameData._i().PlayerHadrole.indexOf(parseInt(e[i].propsname))<0&&GameData._i().PlayerHadrole.push(parseInt(e[i].propsname)):GameData._i().PlayerHadtool.indexOf(parseInt(e[i].propsname))<0&&GameData._i().PlayerHadtool.push(parseInt(e[i].propsname));var a=this.othercontain.getChildByName("infobg"),n=new GameUtil.Menu(this,"rolebtn_png","rolebtn_png",this.showrole);n.setScaleMode(),this.playcontain.addChild(n),GameUtil.relativepos(n,a,122,144);var s=new GameUtil.Menu(this,"toolbtn_png","toolbtn_png",this.showtool);s.setScaleMode(),this.playcontain.addChild(s),GameUtil.relativepos(s,a,122,249),this.showrole()}else console.log(t.msg)},a.showrole=function(){this.bagcontain.removeChildren();for(var t=this.othercontain.getChildByName("infobg"),e=0;e<GameData._i().PlayerHadrole.length;e++){var i="hadroletype_"+GameData._i().PlayerHadrole[e]+"_png",a=new GameUtil.Menu(this,i,i,this.showrolemenu,[GameData._i().PlayerHadrole[e],e]),n=293+105*(e%3),s=153+110*Math.floor(e/3);this.bagcontain.addChild(a),GameUtil.relativepos(a,t,n,s)}},a.showtool=function(){this.bagcontain.removeChildren();for(var t=this.othercontain.getChildByName("infobg"),e=0;e<GameData._i().PlayerHadtool.length;e++){var i="shopselftool_"+GameData._i().PlayerHadtool[e]+"_png",a=new GameUtil.Menu(this,i,i,this.showtoolmenu,[GameData._i().PlayerHadtool[e],e]),n=290+106*(e%3),s=155+110*Math.floor(e/3);a.$setScaleX(.8),a.$setScaleY(.8),this.bagcontain.addChild(a),GameUtil.relativepos(a,t,n,s)}},a.sharegame=function(){var t=new egret.DisplayObjectContainer;this.addChild(t);var e=this,i=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.6);t.addChild(i),i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.removeChild(t)},this);var a=new GameUtil.MyBitmap(RES.getRes("sharetip_png"),this.mStageW,0);a.setanchorOff(1,0),t.addChild(a)},a.showshopbagrole=function(){var t=this.othercontain.getChildByName("shopbg");this.shopbagcontain.removeChildren();for(var e=["皮皮:50泡泡","妞妞:80泡泡","琪琪:100泡泡","明明:120泡泡","聪聪:140泡泡","跳跳:160泡泡"],i=0;6>i;i++){var a="shopself_"+i+"_png",n=new GameUtil.Menu(this,a,a,this.buyrole,[i]),s=144+i%3*173,o=211+254*Math.floor(i/3);this.shopbagcontain.addChild(n),GameUtil.relativepos(n,t,s,o);var r=new GameUtil.MyTextField(n.x,n.y+120,25);r.width=113,r.textAlign=egret.HorizontalAlign.CENTER,r.setText(e[i]),r.textColor=16777215,this.shopbagcontain.addChild(r);for(var h=0;h<GameData._i().PlayerHadrole.length;h++)if(i==GameData._i().PlayerHadrole[h]){r.setText("已拥有"),r.textColor=1742245,n.touchEnabled=!1;break}}},a.showshopbagtool=function(){var t=this.othercontain.getChildByName("shopbg");this.shopbagcontain.removeChildren();for(var e=["蓝色泡泡:50泡泡","黄色泡泡:80泡泡","红包泡泡:100泡泡","紫色泡泡:120泡泡","彩色泡泡:130泡泡","骷髅泡泡:150泡泡"],i=0;6>i;i++){var a="shopselftool_"+i+"_png",n=new GameUtil.Menu(this,a,a,this.buytool,[i]),s=144+i%3*175,o=211+254*Math.floor(i/3);this.shopbagcontain.addChild(n),GameUtil.relativepos(n,t,s,o);var r=new GameUtil.MyTextField(n.x,n.y+120,25);r.width=113,r.textAlign=egret.HorizontalAlign.CENTER,r.setText(e[i]),r.textColor=16777215,this.shopbagcontain.addChild(r);for(var h=0;h<GameData._i().PlayerHadtool.length;h++)if(i==GameData._i().PlayerHadtool[h]){r.setText("已拥有"),r.textColor=1742245,n.touchEnabled=!1;break}}},a.buyrole=function(t){console.log("roleid======",t);var e=new egret.DisplayObjectContainer;e.name="tipcontain",this.othercontain.addChild(e),e.touchEnabled=!0;var i=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.4);e.addChild(i);var a=new GameUtil.MyBitmap(RES.getRes("shoptip_png"),this.mStageW/2,855);e.addChild(a);var n="shopself_"+t+"_png",s=new GameUtil.MyBitmap(RES.getRes(n),this.mStageW/2,785);e.addChild(s);var o=["皮皮","妞妞","琪琪","明明","聪聪","跳跳"],r=this.burolecount,h=new GameUtil.MyTextField(this.mStageW/2,905,30);h.textAlign=egret.HorizontalAlign.CENTER,h.width=355,h.setText("是否消耗"+r[t]+"泡泡领取"+o[t]),h.textColor=8022400,e.addChild(h);var l=new GameUtil.Menu(this,"buybtn_png","buybtn_png",this.getrole,[t]);l.x=this.mStageW/2,l.y=967,l.setScaleMode(),e.addChild(l);var c=new GameUtil.Menu(this,"closebtn_png","closebtn_png",function(){e.parent.removeChild(e)});e.addChild(c),GameUtil.relativepos(c,a,387,1)
},a.buytool=function(t){console.log("toolid=====",t);var e=new egret.DisplayObjectContainer;e.name="tipcontain",this.othercontain.addChild(e),e.touchEnabled=!0;var i=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.4);e.addChild(i);var a=new GameUtil.MyBitmap(RES.getRes("shoptip_png"),this.mStageW/2,855);e.addChild(a);var n="shopselftool_"+t+"_png",s=new GameUtil.MyBitmap(RES.getRes(n),this.mStageW/2,795);e.addChild(s);var o=["蓝色泡泡","黄色泡泡","红包泡泡","紫色泡泡","彩色泡泡","骷髅泡泡"],r=this.butoolcount,h=new GameUtil.MyTextField(this.mStageW/2,905,30);h.textAlign=egret.HorizontalAlign.CENTER,h.width=355,h.setText("是否消耗"+r[t]+"泡泡领取"+o[t]),h.textColor=8022400,e.addChild(h);var l=new GameUtil.Menu(this,"buybtn_png","buybtn_png",this.gettool,[t]);l.x=this.mStageW/2,l.y=967,l.setScaleMode(),e.addChild(l);var c=new GameUtil.Menu(this,"closebtn_png","closebtn_png",function(){e.parent.removeChild(e)});e.addChild(c),GameUtil.relativepos(c,a,387,1)},a.getrole=function(t){var e=this.burolecount;if(GameData._i().PlayerBubbleNumber<e[t])this.addChild(new GameUtil.TipsPanel(null,"泡泡数不够",!0));else{console.log("买买买角色=====",t),this.buyroleortoolID=t;var i={openid:GameData._i().UserInfo.openid,propstype:1,propsname:""+t,paopaocount:e[t]};GameUtil.Http.getinstance().send(i,"/paopao/buyprops",this.getrolesuccess,this)}},a.getrolesuccess=function(t){if(1==t.code){var e=this.burolecount;GameData._i().PlayerHadrole.push(this.buyroleortoolID),GameData._i().PlayerBubbleNumber-=e[this.buyroleortoolID],this.othercontain.removeChild(this.othercontain.getChildByName("tipcontain")),this.showshopbagrole()}else console.log(t.msg)},a.gettool=function(t){var e=this.butoolcount;if(GameData._i().PlayerBubbleNumber<e[t])this.addChild(new GameUtil.TipsPanel(null,"泡泡数不够",!0));else{console.log("买买买道具"),this.buyroleortoolID=t;var i={openid:GameData._i().UserInfo.openid,propstype:1,propsname:""+t,paopaocount:e[t]};GameUtil.Http.getinstance().send(i,"/paopao/buyprops",this.gettoolsuccess,this)}},a.gettoolsuccess=function(t){if(1==t.code){var e=this.butoolcount;GameData._i().PlayerHadtool.push(this.buyroleortoolID),GameData._i().PlayerBubbleNumber-=e[this.buyroleortoolID],this.othercontain.removeChild(this.othercontain.getChildByName("tipcontain")),this.showshopbagtool()}else console.log(t.msg)},a.settingswitch=function(t,e){this.soundswitch[t]=!this.soundswitch[t],e.x+=this.soundswitch[t]?72:-72;var i=this.soundswitch[t]?"settingswitchon_png":"settingswitchoff_png";this.switchbtn[t].setButtonTexture(i,i),GameUtil.GameConfig._i().bgamesound=this.soundswitch[1],GameUtil.GameConfig._i().bgamemusic=this.soundswitch[0];var a=GameUtil.GameConfig._i().bgamemusic?1:0;GameData._i().gamesound[SoundName.startgamebgm].setvolume(a)},a.showotherinfo=function(t){console.log("id====",t);var e={openid:t};GameUtil.Http.getinstance().send(e,"/paopao/getuserinfo",this.getotherinfo,this)},a.getotherinfo=function(t){if(1==t.code){var e=t.result,i=new egret.DisplayObjectContainer;this.othercontain.addChild(i);var a=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.6);i.addChild(a),a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.parent.removeChild(i)},this);var n=new GameUtil.MyBitmap(RES.getRes("showinfobg_png"),this.mStageW/2,this.mStageH/2);i.addChild(n);var s=new GameUtil.MyBitmap(RES.getRes("showinforight_png"),196,this.mStageH/2);i.addChild(s),GameUtil.relativepos(s,n,121,184);var o=new GameUtil.MyBitmap(RES.getRes("showinfoleft_png"),479,this.mStageH/2);i.addChild(o),GameUtil.relativepos(o,n,404,184);var r=new GameUtil.MyBitmap(RES.getRes("roletype_"+GameData._i().PlayerRoleType+"_png"),185,this.mStageH/2);i.addChild(r),GameUtil.relativepos(r,n,110,184);for(var h=["ID:","名字:","泡泡:","总积分:","总击杀:","被杀:"],l=[""+e.openid,e.nickname,""+e.paopaocount,""+e.jifen,""+e.killcount,""+e.bekillcount],c=0;6>c;c++){var u=new GameUtil.MyTextField(340,580+35*c,30,0);u.setText(h[c]),u.textColor=8880072,i.addChild(u),GameUtil.relativepos(u,n,265,100+35*c);var d=new GameUtil.MyTextField(450,580+35*c,30,0);d.setText(l[c]),d.textColor=8880072,i.addChild(d),GameUtil.relativepos(d,n,375,100+35*c)}}else console.log(t.msg)},a.showrolemenu=function(t,e){if(GameData._i().PlayerRoleType!=t){var i=new egret.DisplayObjectContainer;this.othercontain.addChild(i);var a=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.6);i.addChild(a),a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.parent.removeChild(i)},this);var n=370+105*(e%3),s=635+110*Math.floor(e/3),o=new GameUtil.Menu(this,null,null,this.usenewrole,[t,i],GameUtil.createRect(n,s,100,50,1,16777215));o.addButtonText("使用",40,n+50,s+25),i.addChild(o)}},a.showtoolmenu=function(t,e){if(GameData._i().PlayerToolType!=t){var i=new egret.DisplayObjectContainer;this.othercontain.addChild(i);var a=GameUtil.createRect(0,0,this.mStageW,this.mStageH,.6);i.addChild(a),a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.parent.removeChild(i)},this);var n=367+106*(e%3),s=636+110*Math.floor(e/3),o=new GameUtil.Menu(this,null,null,this.usenewtool,[t,i],GameUtil.createRect(n,s,100,50,1,16777215));o.addButtonText("使用",40,n+50,s+25),i.addChild(o)}},a.usenewrole=function(t,e){GameData._i().PlayerRoleType=t,e.parent.removeChild(e)},a.usenewtool=function(t,e){GameData._i().PlayerToolType=t,e.parent.removeChild(e)},a.getrotatag=function(t){switch(t){case 0:return RandomUtils.limit(10,36);case 1:return RandomUtils.limit(37,63);case 2:return RandomUtils.limit(66,112);case 3:return RandomUtils.limit(113,139);case 4:return RandomUtils.limit(140,155);case 5:return RandomUtils.limit(168,201);case 6:return RandomUtils.limit(202,241);case 7:return RandomUtils.limit(242,296);case 8:return RandomUtils.limit(304,333);case 9:return RandomUtils.limit(334,370)}},e}(GameUtil.BassPanel);egret.registerClass(StartGameScene,"StartGameScene");var qr;!function(t){var e=function(){function e(e){this.mode=t.QRMode.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var i=0,a=this.data.length;a>i;i++){var n=[],s=this.data.charCodeAt(i);s>65536?(n[0]=240|(1835008&s)>>>18,n[1]=128|(258048&s)>>>12,n[2]=128|(4032&s)>>>6,n[3]=128|63&s):s>2048?(n[0]=224|(61440&s)>>>12,n[1]=128|(4032&s)>>>6,n[2]=128|63&s):s>128?(n[0]=192|(1984&s)>>>6,n[1]=128|63&s):n[0]=s,this.parsedData.push(n)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}var i=(__define,e),a=i.prototype;return a.getLength=function(t){return this.parsedData.length},a.write=function(t){for(var e=0,i=this.parsedData.length;i>e;e++)t.put(this.parsedData[e],8)},e}();t.QR8bitByte=e,egret.registerClass(e,"qr.QR8bitByte")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){this.buffer=[],this.length=0}var e=(__define,t),i=e.prototype;return i.get=function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},i.put=function(t,e){for(var i=0;e>i;i++)this.putBit(1==(t>>>e-i-1&1))},i.getLengthInBits=function(){return this.length},i.putBit=function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++},t}();t.QRBitBuffer=e,egret.registerClass(e,"qr.QRBitBuffer")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var i=0;i<t.length&&0==t[i];)i++;this.num=new Array(t.length-i+e);for(var a=0;a<t.length-i;a++)this.num[a]=t[a+i]}var i=(__define,e),a=i.prototype;return a.get=function(t){return this.num[t]},a.getLength=function(){return this.num.length},a.multiply=function(i){for(var a=new Array(this.getLength()+i.getLength()-1),n=0;n<this.getLength();n++)for(var s=0;s<i.getLength();s++)a[n+s]^=t.QRMath.gexp(t.QRMath.glog(this.get(n))+t.QRMath.glog(i.get(s)));return new e(a,0)},a.mod=function(i){if(this.getLength()-i.getLength()<0)return this;for(var a=t.QRMath.glog(this.get(0))-t.QRMath.glog(i.get(0)),n=new Array(this.getLength()),s=0;s<this.getLength();s++)n[s]=this.get(s);for(var s=0;s<i.getLength();s++)n[s]^=t.QRMath.gexp(t.QRMath.glog(i.get(s))+a);return new e(n,0).mod(i)},e}();t.QRPolynomial=e,egret.registerClass(e,"qr.QRPolynomial")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}var i=(__define,e);i.prototype;return e.create=function(i,a,n,s,o){void 0===a&&(a=0),void 0===n&&(n=200),void 0===s&&(s=200),void 0===o&&(o=2);var r={width:n,height:s,correctLevel:t.QRErrorCorrectLevel.H,color:a},h=new t.QRCodeModel(t.QRUtil._getTypeNumber(i,r.correctLevel),r.correctLevel);return h.addData(i),h.make(),e.draw(h,r)},e.draw=function(t,e){for(var i=new egret.Sprite,e=e,a=t.getModuleCount(),n=Math.floor(e.width/a),s=Math.floor(e.height/a),o=0;a>o;o++)for(var r=0;a>r;r++){var h=t.isDark(o,r);h&&(i.graphics.beginFill(e.color),i.graphics.drawRect(r*n,o*s,n,s),i.graphics.endFill())}return i},e}();t.QRCode=e,egret.registerClass(e,"qr.QRCode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[],this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var i=(__define,e),a=i.prototype;return a.addData=function(e){var i=new t.QR8bitByte(e);this.dataList.push(i),this.dataCache=null},a.isDark=function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},a.getModuleCount=function(){return this.moduleCount},a.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},a.makeImpl=function(t,i){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var a=0;a<this.moduleCount;a++){this.modules[a]=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[a][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,i),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,i)},a.setupPositionProbePattern=function(t,e){for(var i=-1;7>=i;i++)if(!(-1>=t+i||this.moduleCount<=t+i))for(var a=-1;7>=a;a++)-1>=e+a||this.moduleCount<=e+a||(i>=0&&6>=i&&(0==a||6==a)||a>=0&&6>=a&&(0==i||6==i)||i>=2&&4>=i&&a>=2&&4>=a?this.modules[t+i][e+a]=!0:this.modules[t+i][e+a]=!1)},a.getBestMaskPattern=function(){for(var e=0,i=0,a=0;8>a;a++){this.makeImpl(!0,a);var n=t.QRUtil.getLostPoint(this);(0==a||e>n)&&(e=n,i=a)}return i},a.createMovieClip=function(t,e,i){var a=t.createEmptyMovieClip(e,i),n=1;this.make();for(var s=0;s<this.modules.length;s++)for(var o=s*n,r=0;r<this.modules[s].length;r++){var h=r*n,l=this.modules[s][r];l&&(a.beginFill(0,100),a.moveTo(h,o),a.lineTo(h+n,o),a.lineTo(h+n,o+n),a.lineTo(h,o+n),a.endFill())}return a},a.setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},a.setupPositionAdjustPattern=function(){for(var e=t.QRUtil.getPatternPosition(this.typeNumber),i=0;i<e.length;i++)for(var a=0;a<e.length;a++){var n=e[i],s=e[a];if(null==this.modules[n][s])for(var o=-2;2>=o;o++)for(var r=-2;2>=r;r++)-2==o||2==o||-2==r||2==r||0==o&&0==r?this.modules[n+o][s+r]=!0:this.modules[n+o][s+r]=!1}},a.setupTypeNumber=function(e){for(var i=t.QRUtil.getBCHTypeNumber(this.typeNumber),a=0;18>a;a++){var n=!e&&1==(i>>a&1);this.modules[Math.floor(a/3)][a%3+this.moduleCount-8-3]=n}for(var a=0;18>a;a++){var n=!e&&1==(i>>a&1);this.modules[a%3+this.moduleCount-8-3][Math.floor(a/3)]=n}},a.setupTypeInfo=function(e,i){for(var a=this.errorCorrectLevel<<3|i,n=t.QRUtil.getBCHTypeInfo(a),s=0;15>s;s++){var o=!e&&1==(n>>s&1);6>s?this.modules[s][8]=o:8>s?this.modules[s+1][8]=o:this.modules[this.moduleCount-15+s][8]=o}for(var s=0;15>s;s++){var o=!e&&1==(n>>s&1);8>s?this.modules[8][this.moduleCount-s-1]=o:9>s?this.modules[8][15-s-1+1]=o:this.modules[8][15-s-1]=o}this.modules[this.moduleCount-8][8]=!e},a.mapData=function(e,i){for(var a=-1,n=this.moduleCount-1,s=7,o=0,r=this.moduleCount-1;r>0;r-=2)for(6==r&&r--;;){for(var h=0;2>h;h++)if(null==this.modules[n][r-h]){var l=!1;o<e.length&&(l=1==(e[o]>>>s&1));var c=t.QRUtil.getMask(i,n,r-h);c&&(l=!l),this.modules[n][r-h]=l,s--,-1==s&&(o++,s=7)}if(n+=a,0>n||this.moduleCount<=n){n-=a,a=-a;break}}},e.createData=function(i,a,n){for(var s=t.QRRSBlock.getRSBlocks(i,a),o=new t.QRBitBuffer,r=0;r<n.length;r++){var h=n[r];o.put(h.mode,4),o.put(h.getLength(),t.QRUtil.getLengthInBits(h.mode,i)),h.write(o)}for(var l=0,r=0;r<s.length;r++)l+=s[r].dataCount;if(o.getLengthInBits()>8*l)throw new Error("code length overflow. ("+o.getLengthInBits()+">"+8*l+")");for(o.getLengthInBits()+4<=8*l&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*l)&&(o.put(e.PAD0,8),!(o.getLengthInBits()>=8*l));)o.put(e.PAD1,8);return e.createBytes(o,s)},e.createBytes=function(e,i){for(var a=0,n=0,s=0,o=new Array(i.length),r=new Array(i.length),h=0;h<i.length;h++){var l=i[h].dataCount,c=i[h].totalCount-l;n=Math.max(n,l),s=Math.max(s,c),o[h]=new Array(l);for(var u=0;u<o[h].length;u++)o[h][u]=255&e.buffer[u+a];a+=l;var d=t.QRUtil.getErrorCorrectPolynomial(c),g=new t.QRPolynomial(o[h],d.getLength()-1),m=g.mod(d);r[h]=new Array(d.getLength()-1);for(var u=0;u<r[h].length;u++){var p=u+m.getLength()-r[h].length;r[h][u]=p>=0?m.get(p):0}}for(var f=0,u=0;u<i.length;u++)f+=i[u].totalCount;for(var v=new Array(f),b=0,u=0;n>u;u++)for(var h=0;h<i.length;h++)u<o[h].length&&(v[b++]=o[h][u]);for(var u=0;s>u;u++)for(var h=0;h<i.length;h++)u<r[h].length&&(v[b++]=r[h][u]);return v},e.PAD0=236,e.PAD1=17,e}();t.QRCodeModel=e,egret.registerClass(e,"qr.QRCodeModel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.L=1,t.M=0,t.Q=3,t.H=2,t}();t.QRErrorCorrectLevel=e,egret.registerClass(e,"qr.QRErrorCorrectLevel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.PATTERN000=0,t.PATTERN001=1,t.PATTERN010=2,t.PATTERN011=3,t.PATTERN100=4,t.PATTERN101=5,t.PATTERN110=6,t.PATTERN111=7,t}();t.QRMaskPattern=e,egret.registerClass(e,"qr.QRMaskPattern")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.glog=function(e){return t.isInit||t.init(),1>e&&console.log("错误:n="+e),t.LOG_TABLE[e]},t.gexp=function(e){for(t.isInit||t.init();0>e;)e+=255;for(;e>=256;)e-=255;return t.EXP_TABLE[e]},t.init=function(){t.isInit=!0;for(var e=0;8>e;e++)t.EXP_TABLE[e]=1<<e;for(var e=8;256>e;e++)t.EXP_TABLE[e]=t.EXP_TABLE[e-4]^t.EXP_TABLE[e-5]^t.EXP_TABLE[e-6]^t.EXP_TABLE[e-8];for(var e=0;255>e;e++)t.LOG_TABLE[t.EXP_TABLE[e]]=e},t.EXP_TABLE=new Array(256),t.LOG_TABLE=new Array(256),t}();t.QRMath=e,egret.registerClass(e,"qr.QRMath")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}var e=(__define,t);e.prototype;return t.MODE_NUMBER=1,t.MODE_ALPHA_NUM=2,t.MODE_8BIT_BYTE=4,t.MODE_KANJI=8,t}();t.QRMode=e,egret.registerClass(e,"qr.QRMode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){this.totalCount=t,this.dataCount=e}var i=(__define,e);i.prototype;return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(t,i){var a=e.getRsBlockTable(t,i);if(void 0==a)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+i);for(var n=a.length/3,s=[],o=0;n>o;o++)for(var r=a[3*o+0],h=a[3*o+1],l=a[3*o+2],c=0;r>c;c++)s.push(new e(h,l));return s},e.getRsBlockTable=function(i,a){switch(a){case t.QRErrorCorrectLevel.L:return e.RS_BLOCK_TABLE[4*(i-1)+0];case t.QRErrorCorrectLevel.M:return e.RS_BLOCK_TABLE[4*(i-1)+1];case t.QRErrorCorrectLevel.Q:return e.RS_BLOCK_TABLE[4*(i-1)+2];case t.QRErrorCorrectLevel.H:return e.RS_BLOCK_TABLE[4*(i-1)+3];default:return}},e}();t.QRRSBlock=e,egret.registerClass(e,"qr.QRRSBlock")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}var i=(__define,e),a=i.prototype;return e.getBCHTypeInfo=function(t){for(var i=t<<10;e.getBCHDigit(i)-e.getBCHDigit(e.G15)>=0;)i^=e.G15<<e.getBCHDigit(i)-e.getBCHDigit(e.G15);return(t<<10|i)^e.G15_MASK},e.getBCHTypeNumber=function(t){for(var i=t<<12;e.getBCHDigit(i)-e.getBCHDigit(e.G18)>=0;)i^=e.G18<<e.getBCHDigit(i)-e.getBCHDigit(e.G18);return t<<12|i},e.getBCHDigit=function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},e.getPatternPosition=function(t){return e.PATTERN_POSITION_TABLE[t-1]},e.getMask=function(e,i,a){switch(e){case t.QRMaskPattern.PATTERN000:return(i+a)%2==0;case t.QRMaskPattern.PATTERN001:return i%2==0;case t.QRMaskPattern.PATTERN010:return a%3==0;case t.QRMaskPattern.PATTERN011:return(i+a)%3==0;case t.QRMaskPattern.PATTERN100:return(Math.floor(i/2)+Math.floor(a/3))%2==0;case t.QRMaskPattern.PATTERN101:return i*a%2+i*a%3==0;case t.QRMaskPattern.PATTERN110:return(i*a%2+i*a%3)%2==0;case t.QRMaskPattern.PATTERN111:return(i*a%3+(i+a)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},e.getErrorCorrectPolynomial=function(e){for(var i=new t.QRPolynomial([1],0),a=0;e>a;a++)i=i.multiply(new t.QRPolynomial([1,t.QRMath.gexp(a)],0));return i},e.getLengthInBits=function(e,i){if(i>=1&&10>i)switch(e){case t.QRMode.MODE_NUMBER:return 10;case t.QRMode.MODE_ALPHA_NUM:return 9;case t.QRMode.MODE_8BIT_BYTE:return 8;case t.QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(27>i)switch(e){case t.QRMode.MODE_NUMBER:return 12;case t.QRMode.MODE_ALPHA_NUM:return 11;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(41>i))throw new Error("type:"+i);switch(e){case t.QRMode.MODE_NUMBER:return 14;case t.QRMode.MODE_ALPHA_NUM:return 13;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},e.getLostPoint=function(t){for(var e=t.getModuleCount(),i=0,a=0;e>a;a++)for(var n=0;e>n;n++){for(var s=0,o=t.isDark(a,n),r=-1;1>=r;r++)if(!(0>a+r||a+r>=e))for(var h=-1;1>=h;h++)0>n+h||n+h>=e||(0!=r||0!=h)&&o==t.isDark(a+r,n+h)&&s++;s>5&&(i+=3+s-5)}for(var a=0;e-1>a;a++)for(var n=0;e-1>n;n++){var l=0;t.isDark(a,n)&&l++,t.isDark(a+1,n)&&l++,t.isDark(a,n+1)&&l++,t.isDark(a+1,n+1)&&l++,(0==l||4==l)&&(i+=3)}for(var a=0;e>a;a++)for(var n=0;e-6>n;n++)t.isDark(a,n)&&!t.isDark(a,n+1)&&t.isDark(a,n+2)&&t.isDark(a,n+3)&&t.isDark(a,n+4)&&!t.isDark(a,n+5)&&t.isDark(a,n+6)&&(i+=40);for(var n=0;e>n;n++)for(var a=0;e-6>a;a++)t.isDark(a,n)&&!t.isDark(a+1,n)&&t.isDark(a+2,n)&&t.isDark(a+3,n)&&t.isDark(a+4,n)&&!t.isDark(a+5,n)&&t.isDark(a+6,n)&&(i+=40);for(var c=0,n=0;e>n;n++)for(var a=0;e>a;a++)t.isDark(a,n)&&c++;var u=Math.abs(100*c/e/e-50)/5;return i+=10*u},a.static_isSupportCanvas=function(){return"undefined"!=typeof CanvasRenderingContext2D},e._getTypeNumber=function(i,a){for(var n=1,s=e._getUTF8Length(i),o=0,r=e.QRCodeLimitLength.length;r>=o;o++){var h=0;switch(a){case t.QRErrorCorrectLevel.L:h=e.QRCodeLimitLength[o][0];break;case t.QRErrorCorrectLevel.M:h=e.QRCodeLimitLength[o][1];break;case t.QRErrorCorrectLevel.Q:h=e.QRCodeLimitLength[o][2];break;case t.QRErrorCorrectLevel.H:h=e.QRCodeLimitLength[o][3]}if(h>=s)break;n++}if(n>e.QRCodeLimitLength.length)throw new Error("Too long data");return n},e._getUTF8Length=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)},e.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],e.G15=1335,e.G18=7973,e.G15_MASK=21522,e.QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],e}();t.QRUtil=e,egret.registerClass(e,"qr.QRUtil")}(qr||(qr={}));